View(gdd.stan)
View(gdd)
commoncols <- c("id", "provenance.lat", "fs.count", "year", "budburst", "spp")
gdd.hobo <- subset(gdd.hobo, select=c(commoncols, "gdd_bb_hobo", "gdd_dvr_hobo"))
gdd.stan <- subset(gdd.stan, select=c(commoncols, "gdd_bb", "gdd_dvr"))
gdd <- full_join(gdd.stan, gdd.hobo)
gdd <- gdd[(gdd$year==2019),]
gdd <- gdd[(gdd$gdd_bb<=1000),]
gdd <- gdd[(gdd$gdd_bb_hobo<=1000),]
gdd$gdd.diffdvr <- gdd$gdd_dvr_hobo - gdd$gdd_dvr ## mean=3.81; range=c(-1.24, 12.17); sd=3.77
gdd$gdd.diffbb <- gdd$gdd_bb_hobo - gdd$gdd_bb ## mean = 5.18; range=c(3.48, 9.95); sd=1.82
cols <- colorRampPalette(brewer.pal(8,"Dark2"))(8)
gddplot.bb <- subset(gdd, select=c("provenance.lat", "fs.count", "spp", "gdd_bb", "gdd_bb_hobo"))
gddplot.dvr <- subset(gdd, select=c("provenance.lat", "fs.count", "spp", "gdd_dvr", "gdd_dvr_hobo"))
gddplot.bb <- na.omit(gddplot.bb)
gddplot.dvr <- na.omit(gddplot.dvr)
gddplot.bb <- gather(gddplot.bb, "method", "gdd", -provenance.lat, -fs.count, -spp)
gddplot.dvr <- gather(gddplot.dvr, "method", "gdd", -provenance.lat, -fs.count, -spp)
gddplot.bb$gddmean <- ave(gddplot.bb$gdd, gddplot.bb$spp, gddplot.bb$method)
gddplot.bb$gddsd <- ave(gddplot.bb$gdd, gddplot.bb$spp, gddplot.bb$method, FUN=sd)
gddplot.bb$ymin <- gddplot.bb$gddmean-gddplot.bb$gddsd
gddplot.bb$ymax <- gddplot.bb$gddmean+gddplot.bb$gddsd
gddplot.dvr$gddmean <- ave(gddplot.dvr$gdd, gddplot.dvr$spp, gddplot.dvr$method)
gddplot.dvr$gddsd <- ave(gddplot.dvr$gdd, gddplot.dvr$spp, gddplot.dvr$method, FUN=sd)
gddplot.dvr$ymin <- gddplot.dvr$gddmean-gddplot.dvr$gddsd
gddplot.dvr$ymax <- gddplot.dvr$gddmean+gddplot.dvr$gddsd
gddbarbb <- ggplot(gddplot.bb, aes(x=spp, y=gddmean, fill=method)) +
geom_bar(stat="identity", position=position_dodge()) +
geom_errorbar(aes(ymin=ymin, ymax=ymax),width = 0.2, position=position_dodge(0.9)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_fill_manual(name="Method", values=cols,
labels=c("Weather Station", "Hobo Logger")) + coord_cartesian(expand=c(0,0))
quartz()
gddbarbb
gddbardvr <- ggplot(gddplot.dvr, aes(x=spp, y=gddmean, fill=method)) +
geom_bar(stat="identity", position=position_dodge()) +
geom_errorbar(aes(ymin=ymin, ymax=ymax),width = 0.2, position=position_dodge(0.9)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white")) +
xlab("") +
ylab("Growing degree days from budburst to leafout") +
scale_fill_manual(name="Method", values=cols,
labels=c("Weather Station", "Hobo Logger")) + coord_cartesian(expand=c(0,0))
quartz()
gddbardvr
View(gddplot.bb)
View(gddplot.bb)
gddplot.bb <- subset(gdd, select=c("provenance.lat", "fs.count", "spp", "gdd_bb", "gdd_bb_hobo", "budburst"))
gddplot.dvr <- subset(gdd, select=c("provenance.lat", "fs.count", "spp", "gdd_dvr", "gdd_dvr_hobo", "budburst"))
gddplot.bb <- na.omit(gddplot.bb)
gddplot.dvr <- na.omit(gddplot.dvr)
gddplot.bb <- gather(gddplot.bb, "method", "gdd", -provenance.lat, -fs.count, -spp)
gddplot.dvr <- gather(gddplot.dvr, "method", "gdd", -provenance.lat, -fs.count, -spp)
gddplot.bb$gddmean <- ave(gddplot.bb$gdd, gddplot.bb$spp, gddplot.bb$method)
gddplot.bb$gddsd <- ave(gddplot.bb$gdd, gddplot.bb$spp, gddplot.bb$method, FUN=sd)
gddplot.bb$ymin <- gddplot.bb$gddmean-gddplot.bb$gddsd
gddplot.bb$ymax <- gddplot.bb$gddmean+gddplot.bb$gddsd
gddplot.dvr$gddmean <- ave(gddplot.dvr$gdd, gddplot.dvr$spp, gddplot.dvr$method)
gddplot.dvr$gddsd <- ave(gddplot.dvr$gdd, gddplot.dvr$spp, gddplot.dvr$method, FUN=sd)
gddplot.dvr$ymin <- gddplot.dvr$gddmean-gddplot.dvr$gddsd
gddplot.dvr$ymax <- gddplot.dvr$gddmean+gddplot.dvr$gddsd
quartz()
ggplot(gddplot.bb, aes(x=budburst, y=gdd, col=method, linetype=method)) + geom_point() +
geom_line() + scale_color_manual(name="Method", values=cols,
labels=c("Weather Station", "Hobo Logger")) + coord_cartesian(expand=c(0,0))
gddplot.bb <- subset(gdd, select=c("provenance.lat", "fs.count", "spp", "gdd_bb", "gdd_bb_hobo", "budburst"))
gddplot.dvr <- subset(gdd, select=c("provenance.lat", "fs.count", "spp", "gdd_dvr", "gdd_dvr_hobo", "budburst"))
gddplot.bb <- na.omit(gddplot.bb)
gddplot.dvr <- na.omit(gddplot.dvr)
gddplot.bb <- gather(gddplot.bb, "method", "gdd", -provenance.lat, -fs.count, -spp, -budburst)
gddplot.dvr <- gather(gddplot.dvr, "method", "gdd", -provenance.lat, -fs.count, -spp, -budburst)
gddplot.bb$gddmean <- ave(gddplot.bb$gdd, gddplot.bb$spp, gddplot.bb$method)
gddplot.bb$gddsd <- ave(gddplot.bb$gdd, gddplot.bb$spp, gddplot.bb$method, FUN=sd)
gddplot.bb$ymin <- gddplot.bb$gddmean-gddplot.bb$gddsd
gddplot.bb$ymax <- gddplot.bb$gddmean+gddplot.bb$gddsd
gddplot.dvr$gddmean <- ave(gddplot.dvr$gdd, gddplot.dvr$spp, gddplot.dvr$method)
gddplot.dvr$gddsd <- ave(gddplot.dvr$gdd, gddplot.dvr$spp, gddplot.dvr$method, FUN=sd)
gddplot.dvr$ymin <- gddplot.dvr$gddmean-gddplot.dvr$gddsd
gddplot.dvr$ymax <- gddplot.dvr$gddmean+gddplot.dvr$gddsd
ggplot(gddplot.bb, aes(x=budburst, y=gdd, col=method, linetype=method)) + geom_point() +
geom_line() + scale_color_manual(name="Method", values=cols,
labels=c("Weather Station", "Hobo Logger")) + coord_cartesian(expand=c(0,0))
rm(list=ls())
options(stringsAsFactors = FALSE)
# Load libraries
library(RColorBrewer)
library(ggplot2)
library(dplyr)
library(tidyr)
# Set working directory
setwd("~/Documents/git/microclimates/analyses")
## Load the data
gdd.stan <- read.csv("output/clean_gdd_bbanddvr.csv", header=TRUE)
gdd.hobo <- read.csv("output/clean_gdd_bbanddvr_hobo.csv", header=TRUE)
if(FALSE){ ## Testing code
gdd.stan$stationbb <- gdd.stan$gdd_bb
gdd.stan$gdd_bb <- NULL
gdd.stan$stationdvr <- gdd.stan$gdd_dvr
gdd.stan$gdd_dvr <- NULL
gdd <- left_join(gdd.hobo, gdd.stan)
gdd$diffbb <- gdd$stationbb - gdd$gdd_bb
gdd$diffdvr <- gdd$stationdvr - gdd$gdd_dvr
range(gdd$diffdvr, na.rm=TRUE)
range(gdd$diffbb, na.rm=TRUE)
}
gdd.stan <- gdd.stan[(gdd.stan$type=="Treespotters"),]
gdd.hobo <- gdd.hobo[(gdd.hobo$type=="Treespotters"),]
gdd.hobo$gdd_bb_hobo <- gdd.hobo$gdd_bb
gdd.hobo$gdd_dvr_hobo <- gdd.hobo$gdd_dvr
gdd.hobo$gdd_bb <- NULL
gdd.hobo$gdd_dvr <- NULL
gdd.hobo$spp <- paste(substr(gdd.hobo$genus, 0, 3), substr(gdd.hobo$species, 0, 3), sep="")
gdd.stan$spp <- paste(substr(gdd.stan$genus, 0, 3), substr(gdd.stan$species, 0, 3), sep="")
commoncols <- c("id", "provenance.lat", "fs.count", "year", "budburst", "spp", "climatetype")
gdd.hobo <- subset(gdd.hobo, select=c(commoncols, "gdd_bb_hobo", "gdd_dvr_hobo"))
gdd.stan <- subset(gdd.stan, select=c(commoncols, "gdd_bb", "gdd_dvr"))
gdd.hobo$hobonum <- gdd.hobo$climatetype
gdd.hobo$climatetype <- NULL
gdd <- full_join(gdd.stan, gdd.hobo)
gdd <- gdd[(gdd$year==2019),]
gdd <- gdd[(gdd$gdd_bb<=1000),]
gdd <- gdd[(gdd$gdd_bb_hobo<=1000),]
gdd$gdd.diffdvr <- gdd$gdd_dvr_hobo - gdd$gdd_dvr ## mean=3.81; range=c(-1.24, 12.17); sd=3.77
gdd$gdd.diffbb <- gdd$gdd_bb_hobo - gdd$gdd_bb ## mean = 5.18; range=c(3.48, 9.95); sd=1.82
cols <- colorRampPalette(brewer.pal(8,"Dark2"))(8)
View(gdd)
gddplot.bb <- subset(gdd, select=c("provenance.lat", "fs.count", "spp", "gdd_bb", "gdd_bb_hobo", "budburst", "hobonum"))
View(gddplot.bb)
gddplot.dvr <- subset(gdd, select=c("provenance.lat", "fs.count", "spp", "gdd_dvr", "gdd_dvr_hobo", "budburst", "hobonum"))
gddplot.bb <- na.omit(gddplot.bb)
gddplot.dvr <- na.omit(gddplot.dvr)
gddplot.bb <- gather(gddplot.bb, "method", "gdd", -provenance.lat, -fs.count, -spp, -budburst, -hobonum)
gddplot.dvr <- gather(gddplot.dvr, "method", "gdd", -provenance.lat, -fs.count, -spp, -budburst, -hobonum)
View(gddplot.bb)
gddplot.bb$method <- ifelse(gddplot.bb$method=="gdd_bb", gddplot.bb$method, gddplot.bb$hobonum)
gddplot.dvr$method <- ifelse(gddplot.dvr$method=="gdd_dvr", gddplot.dvr$method, gddplot.dvr$hobonum)
View(gddplot.bb)
gddplot.bb$gddmean <- ave(gddplot.bb$gdd, gddplot.bb$spp, gddplot.bb$method)
gddplot.bb$gddsd <- ave(gddplot.bb$gdd, gddplot.bb$spp, gddplot.bb$method, FUN=sd)
gddplot.bb$ymin <- gddplot.bb$gddmean-gddplot.bb$gddsd
gddplot.bb$ymax <- gddplot.bb$gddmean+gddplot.bb$gddsd
gddplot.dvr$gddmean <- ave(gddplot.dvr$gdd, gddplot.dvr$spp, gddplot.dvr$method)
gddplot.dvr$gddsd <- ave(gddplot.dvr$gdd, gddplot.dvr$spp, gddplot.dvr$method, FUN=sd)
gddplot.dvr$ymin <- gddplot.dvr$gddmean-gddplot.dvr$gddsd
gddplot.dvr$ymax <- gddplot.dvr$gddmean+gddplot.dvr$gddsd
sort(unique(gddplot.bb$method))
quartz()
ggplot(gddplot.bb, aes(x=budburst, y=gdd, col=method, linetype=method)) + geom_point() +
geom_line() + scale_color_manual(name="Method", values=cols,
labels=c("Hobo #10", "Hobo #11",
"Hobo #12", "Hobo #14",
"Hobo #15", "Hobo #2",
"Hobo #3", "Hobo #4",
"Hobo #7", "Hobo #8",
"Hobo #9", "Weather Station")) +
coord_cartesian(expand=c(0,0))
cols <- colorRampPalette(brewer.pal(12,"Set3"))(12)
ggplot(gddplot.bb, aes(x=budburst, y=gdd, col=method, linetype=method)) + geom_point() +
geom_line() + scale_color_manual(name="Method", values=cols,
labels=c("Hobo #10", "Hobo #11",
"Hobo #12", "Hobo #14",
"Hobo #15", "Hobo #2",
"Hobo #3", "Hobo #4",
"Hobo #7", "Hobo #8",
"Hobo #9", "Weather Station")) +
coord_cartesian(expand=c(0,0))
ggplot(gddplot.bb, aes(x=budburst, y=gdd, col=method, linetype=method)) + geom_point() +
geom_line() + scale_color_manual(name="Method", values=c(cols, "black"),
labels=c("Hobo #10", "Hobo #11",
"Hobo #12", "Hobo #14",
"Hobo #15", "Hobo #2",
"Hobo #3", "Hobo #4",
"Hobo #7", "Hobo #8",
"Hobo #9", "Weather Station")) +
coord_cartesian(expand=c(0,0)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white")) +
xlab("Day of budburst") + ylab("Growing degree days")
ggplot(gddplot.bb, aes(x=budburst, y=gdd, col=method, linetype=method)) + geom_point() +
geom_line() + scale_color_manual(name="Method", values=c(cols, "black"),
labels=c("Hobo #10", "Hobo #11",
"Hobo #12", "Hobo #14",
"Hobo #15", "Hobo #2",
"Hobo #3", "Hobo #4",
"Hobo #7", "Hobo #8",
"Hobo #9", "Weather Station")) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
#axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white")) +
xlab("Day of budburst") + ylab("Growing degree days")
ggplot(gddplot.bb, aes(x=budburst, y=gdd, col=method, linetype=method)) + geom_point() +
geom_line() + scale_color_manual(name="Method", values=c(cols, "black"),
labels=c("Hobo #10", "Hobo #11",
"Hobo #12", "Hobo #14",
"Hobo #15", "Hobo #2",
"Hobo #3", "Hobo #4",
"Hobo #7", "Hobo #8",
"Hobo #9", "Weather Station")) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
#axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white")) +
xlab("Day of budburst") + ylab("Growing degree days") + guides(linetype=FALSE)
cols <- colorRampPalette(brewer.pal(12,"Dark2"))(11)
cols <- colorRampPalette(brewer.pal(12,"Set3"))(11)
cols <- c(cols, "black")
ggplot(gddplot.bb, aes(x=budburst, y=gdd, col=method, linetype=method)) + geom_point() +
geom_line() + scale_color_manual(name="Method", values=cols,
labels=c("Hobo #10", "Hobo #11",
"Hobo #12", "Hobo #14",
"Hobo #15", "Hobo #2",
"Hobo #3", "Hobo #4",
"Hobo #7", "Hobo #8",
"Hobo #9", "Weather Station")) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
#axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white")) +
xlab("Day of budburst") + ylab("Growing degree days") + guides(linetype=FALSE)
cols <- colorRampPalette(brewer.pal(11,"Set3"))(11)
cols <- c(cols, "black")
ggplot(gddplot.bb, aes(x=budburst, y=gdd, col=method, linetype=method)) + geom_point() +
geom_line() + scale_color_manual(name="Method", values=cols,
labels=c("Hobo #10", "Hobo #11",
"Hobo #12", "Hobo #14",
"Hobo #15", "Hobo #2",
"Hobo #3", "Hobo #4",
"Hobo #7", "Hobo #8",
"Hobo #9", "Weather Station")) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
#axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white")) +
xlab("Day of budburst") + ylab("Growing degree days") + guides(linetype=FALSE)
View(gdd)
rm(list=ls())
options(stringsAsFactors = FALSE)
# Load libraries
library(RColorBrewer)
library(ggplot2)
library(dplyr)
library(tidyr)
# Set working directory
setwd("~/Documents/git/microclimates/analyses")
## Load the data
gdd.stan <- read.csv("output/clean_gdd_bbanddvr.csv", header=TRUE)
gdd.hobo <- read.csv("output/clean_gdd_bbanddvr_hobo.csv", header=TRUE)
if(FALSE){ ## Testing code
gdd.stan$stationbb <- gdd.stan$gdd_bb
gdd.stan$gdd_bb <- NULL
gdd.stan$stationdvr <- gdd.stan$gdd_dvr
gdd.stan$gdd_dvr <- NULL
gdd <- left_join(gdd.hobo, gdd.stan)
gdd$diffbb <- gdd$stationbb - gdd$gdd_bb
gdd$diffdvr <- gdd$stationdvr - gdd$gdd_dvr
range(gdd$diffdvr, na.rm=TRUE)
range(gdd$diffbb, na.rm=TRUE)
}
gdd.stan <- gdd.stan[(gdd.stan$type=="Treespotters"),]
gdd.hobo <- gdd.hobo[(gdd.hobo$type=="Treespotters"),]
gdd.hobo$gdd_bb_hobo <- gdd.hobo$gdd_bb
gdd.hobo$gdd_dvr_hobo <- gdd.hobo$gdd_dvr
gdd.hobo$gdd_bb <- NULL
gdd.hobo$gdd_dvr <- NULL
gdd.hobo$spp <- paste(substr(gdd.hobo$genus, 0, 3), substr(gdd.hobo$species, 0, 3), sep="")
gdd.stan$spp <- paste(substr(gdd.stan$genus, 0, 3), substr(gdd.stan$species, 0, 3), sep="")
commoncols <- c("id", "provenance.lat", "fs.count", "year", "budburst", "leafout", "spp", "climatetype")
gdd.hobo <- subset(gdd.hobo, select=c(commoncols, "gdd_bb_hobo", "gdd_dvr_hobo"))
gdd.stan <- subset(gdd.stan, select=c(commoncols, "gdd_bb", "gdd_dvr"))
gdd.hobo$hobonum <- gdd.hobo$climatetype
gdd.hobo$climatetype <- NULL
gdd <- full_join(gdd.stan, gdd.hobo)
gdd$dvr <- gdd$budburst - gdd$leafout
gdd$leafout <- NULL
gdd <- gdd[(gdd$year==2019),]
gdd <- gdd[(gdd$gdd_bb<=1000),]
gdd <- gdd[(gdd$gdd_bb_hobo<=1000),]
gdd$gdd.diffdvr <- gdd$gdd_dvr_hobo - gdd$gdd_dvr ## mean=3.81; range=c(-1.24, 12.17); sd=3.77
gdd$gdd.diffbb <- gdd$gdd_bb_hobo - gdd$gdd_bb ## mean = 5.18; range=c(3.48, 9.95); sd=1.82
gddplot.bb <- subset(gdd, select=c("provenance.lat", "fs.count", "spp", "gdd_bb", "gdd_bb_hobo", "budburst", "hobonum"))
gddplot.dvr <- subset(gdd, select=c("provenance.lat", "fs.count", "spp", "gdd_dvr", "gdd_dvr_hobo", "budburst", "hobonum"))
gddplot.bb <- na.omit(gddplot.bb)
gddplot.dvr <- na.omit(gddplot.dvr)
gddplot.bb <- gather(gddplot.bb, "method", "gdd", -provenance.lat, -fs.count, -spp, -budburst, -hobonum, -dvr)
gddplot.dvr <- gather(gddplot.dvr, "method", "gdd", -provenance.lat, -fs.count, -spp, -budburst, -hobonum, -dvr)
gddplot.bb$method <- ifelse(gddplot.bb$method=="gdd_bb", gddplot.bb$method, gddplot.bb$hobonum)
gddplot.dvr$method <- ifelse(gddplot.dvr$method=="gdd_dvr", gddplot.dvr$method, gddplot.dvr$hobonum)
gddplot.bb$gddmean <- ave(gddplot.bb$gdd, gddplot.bb$spp, gddplot.bb$method)
gddplot.bb$gddsd <- ave(gddplot.bb$gdd, gddplot.bb$spp, gddplot.bb$method, FUN=sd)
gddplot.bb$ymin <- gddplot.bb$gddmean-gddplot.bb$gddsd
gddplot.bb$ymax <- gddplot.bb$gddmean+gddplot.bb$gddsd
gddplot.dvr$gddmean <- ave(gddplot.dvr$gdd, gddplot.dvr$spp, gddplot.dvr$method)
gddplot.dvr$gddsd <- ave(gddplot.dvr$gdd, gddplot.dvr$spp, gddplot.dvr$method, FUN=sd)
gddplot.dvr$ymin <- gddplot.dvr$gddmean-gddplot.dvr$gddsd
gddplot.dvr$ymax <- gddplot.dvr$gddmean+gddplot.dvr$gddsd
rm(list=ls())
options(stringsAsFactors = FALSE)
# Load libraries
library(RColorBrewer)
library(ggplot2)
library(dplyr)
library(tidyr)
# Set working directory
setwd("~/Documents/git/microclimates/analyses")
## Load the data
gdd.stan <- read.csv("output/clean_gdd_bbanddvr.csv", header=TRUE)
gdd.hobo <- read.csv("output/clean_gdd_bbanddvr_hobo.csv", header=TRUE)
if(FALSE){ ## Testing code
gdd.stan$stationbb <- gdd.stan$gdd_bb
gdd.stan$gdd_bb <- NULL
gdd.stan$stationdvr <- gdd.stan$gdd_dvr
gdd.stan$gdd_dvr <- NULL
gdd <- left_join(gdd.hobo, gdd.stan)
gdd$diffbb <- gdd$stationbb - gdd$gdd_bb
gdd$diffdvr <- gdd$stationdvr - gdd$gdd_dvr
range(gdd$diffdvr, na.rm=TRUE)
range(gdd$diffbb, na.rm=TRUE)
}
gdd.stan <- gdd.stan[(gdd.stan$type=="Treespotters"),]
gdd.hobo <- gdd.hobo[(gdd.hobo$type=="Treespotters"),]
gdd.hobo$gdd_bb_hobo <- gdd.hobo$gdd_bb
gdd.hobo$gdd_dvr_hobo <- gdd.hobo$gdd_dvr
gdd.hobo$gdd_bb <- NULL
gdd.hobo$gdd_dvr <- NULL
gdd.hobo$spp <- paste(substr(gdd.hobo$genus, 0, 3), substr(gdd.hobo$species, 0, 3), sep="")
gdd.stan$spp <- paste(substr(gdd.stan$genus, 0, 3), substr(gdd.stan$species, 0, 3), sep="")
commoncols <- c("id", "provenance.lat", "fs.count", "year", "budburst", "leafout", "spp", "climatetype")
gdd.hobo <- subset(gdd.hobo, select=c(commoncols, "gdd_bb_hobo", "gdd_dvr_hobo"))
gdd.stan <- subset(gdd.stan, select=c(commoncols, "gdd_bb", "gdd_dvr"))
gdd.hobo$hobonum <- gdd.hobo$climatetype
gdd.hobo$climatetype <- NULL
gdd <- full_join(gdd.stan, gdd.hobo)
gdd$dvr <- gdd$budburst - gdd$leafout
gdd$leafout <- NULL
gdd <- gdd[(gdd$year==2019),]
gdd <- gdd[(gdd$gdd_bb<=1000),]
gdd <- gdd[(gdd$gdd_bb_hobo<=1000),]
gdd$gdd.diffdvr <- gdd$gdd_dvr_hobo - gdd$gdd_dvr ## mean=3.81; range=c(-1.24, 12.17); sd=3.77
gdd$gdd.diffbb <- gdd$gdd_bb_hobo - gdd$gdd_bb ## mean = 5.18; range=c(3.48, 9.95); sd=1.82
gddplot.bb <- subset(gdd, select=c("provenance.lat", "fs.count", "spp", "gdd_bb", "gdd_bb_hobo", "budburst", "hobonum", "dvr"))
gddplot.dvr <- subset(gdd, select=c("provenance.lat", "fs.count", "spp", "gdd_dvr", "gdd_dvr_hobo", "budburst", "hobonum", "dvr"))
gddplot.bb <- na.omit(gddplot.bb)
gddplot.dvr <- na.omit(gddplot.dvr)
gddplot.bb <- gather(gddplot.bb, "method", "gdd", -provenance.lat, -fs.count, -spp, -budburst, -hobonum, -dvr)
gddplot.dvr <- gather(gddplot.dvr, "method", "gdd", -provenance.lat, -fs.count, -spp, -budburst, -hobonum, -dvr)
gddplot.bb$method <- ifelse(gddplot.bb$method=="gdd_bb", gddplot.bb$method, gddplot.bb$hobonum)
gddplot.dvr$method <- ifelse(gddplot.dvr$method=="gdd_dvr", gddplot.dvr$method, gddplot.dvr$hobonum)
gddplot.bb$gddmean <- ave(gddplot.bb$gdd, gddplot.bb$spp, gddplot.bb$method)
gddplot.bb$gddsd <- ave(gddplot.bb$gdd, gddplot.bb$spp, gddplot.bb$method, FUN=sd)
gddplot.bb$ymin <- gddplot.bb$gddmean-gddplot.bb$gddsd
gddplot.bb$ymax <- gddplot.bb$gddmean+gddplot.bb$gddsd
gddplot.dvr$gddmean <- ave(gddplot.dvr$gdd, gddplot.dvr$spp, gddplot.dvr$method)
gddplot.dvr$gddsd <- ave(gddplot.dvr$gdd, gddplot.dvr$spp, gddplot.dvr$method, FUN=sd)
gddplot.dvr$ymin <- gddplot.dvr$gddmean-gddplot.dvr$gddsd
gddplot.dvr$ymax <- gddplot.dvr$gddmean+gddplot.dvr$gddsd
cols <- colorRampPalette(brewer.pal(11,"Set3"))(11)
cols <- c(cols, "black")
bb.loggers <- ggplot(gddplot.bb, aes(x=budburst, y=gdd, col=method, linetype=method)) + geom_point() +
geom_line() + scale_color_manual(name="Method", values=cols,
labels=c("Hobo #10", "Hobo #11",
"Hobo #12", "Hobo #14",
"Hobo #15", "Hobo #2",
"Hobo #3", "Hobo #4",
"Hobo #7", "Hobo #8",
"Hobo #9", "Weather Station")) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
#axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white")) +
xlab("Day of budburst") + ylab("Growing degree days") + guides(linetype=FALSE)
quartz()
bb.loggers
dvr.loggers <- ggplot(gddplot.dvr, aes(x=budburst, y=gdd, col=method, linetype=method)) + geom_point() +
geom_line() + scale_color_manual(name="Method", values=cols,
labels=c("Hobo #10", "Hobo #11",
"Hobo #12", "Hobo #14",
"Hobo #15", "Hobo #2",
"Hobo #3", "Hobo #4",
"Hobo #7", "Hobo #8",
"Hobo #9", "Weather Station")) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
#axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white")) +
xlab("Day of budburst") + ylab("Growing degree days") + guides(linetype=FALSE)
quartz()
dvr.loggers
dvr.loggers <- ggplot(gddplot.dvr, aes(x=dvr, y=gdd, col=method, linetype=method)) + geom_point() +
geom_line() + scale_color_manual(name="Method", values=cols,
labels=c("Hobo #10", "Hobo #11",
"Hobo #12", "Hobo #14",
"Hobo #15", "Hobo #2",
"Hobo #3", "Hobo #4",
"Hobo #7", "Hobo #8",
"Hobo #9", "Weather Station")) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
#axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white")) +
xlab("Days from budburst to leafout") + ylab("Growing degree days") + guides(linetype=FALSE)
dvr.loggers
rm(list=ls())
options(stringsAsFactors = FALSE)
# Load libraries
library(RColorBrewer)
library(ggplot2)
library(dplyr)
library(tidyr)
# Set working directory
setwd("~/Documents/git/microclimates/analyses")
## Load the data
gdd.stan <- read.csv("output/clean_gdd_bbanddvr.csv", header=TRUE)
gdd.hobo <- read.csv("output/clean_gdd_bbanddvr_hobo.csv", header=TRUE)
if(FALSE){ ## Testing code
gdd.stan$stationbb <- gdd.stan$gdd_bb
gdd.stan$gdd_bb <- NULL
gdd.stan$stationdvr <- gdd.stan$gdd_dvr
gdd.stan$gdd_dvr <- NULL
gdd <- left_join(gdd.hobo, gdd.stan)
gdd$diffbb <- gdd$stationbb - gdd$gdd_bb
gdd$diffdvr <- gdd$stationdvr - gdd$gdd_dvr
range(gdd$diffdvr, na.rm=TRUE)
range(gdd$diffbb, na.rm=TRUE)
}
gdd.stan <- gdd.stan[(gdd.stan$type=="Treespotters"),]
gdd.hobo <- gdd.hobo[(gdd.hobo$type=="Treespotters"),]
gdd.hobo$gdd_bb_hobo <- gdd.hobo$gdd_bb
gdd.hobo$gdd_dvr_hobo <- gdd.hobo$gdd_dvr
gdd.hobo$gdd_bb <- NULL
gdd.hobo$gdd_dvr <- NULL
gdd.hobo$spp <- paste(substr(gdd.hobo$genus, 0, 3), substr(gdd.hobo$species, 0, 3), sep="")
gdd.stan$spp <- paste(substr(gdd.stan$genus, 0, 3), substr(gdd.stan$species, 0, 3), sep="")
commoncols <- c("id", "provenance.lat", "fs.count", "year", "budburst", "leafout", "spp", "climatetype")
gdd.hobo <- subset(gdd.hobo, select=c(commoncols, "gdd_bb_hobo", "gdd_dvr_hobo"))
gdd.stan <- subset(gdd.stan, select=c(commoncols, "gdd_bb", "gdd_dvr"))
gdd.hobo$hobonum <- gdd.hobo$climatetype
gdd.hobo$climatetype <- NULL
gdd <- full_join(gdd.stan, gdd.hobo)
gdd$dvr <- gdd$leafout - gdd$budburst
gdd$leafout <- NULL
gdd <- gdd[(gdd$year==2019),]
gdd <- gdd[(gdd$gdd_bb<=1000),]
gdd <- gdd[(gdd$gdd_bb_hobo<=1000),]
gdd$gdd.diffdvr <- gdd$gdd_dvr_hobo - gdd$gdd_dvr ## mean=3.81; range=c(-1.24, 12.17); sd=3.77
gdd$gdd.diffbb <- gdd$gdd_bb_hobo - gdd$gdd_bb ## mean = 5.18; range=c(3.48, 9.95); sd=1.82
gddplot.bb <- subset(gdd, select=c("provenance.lat", "fs.count", "spp", "gdd_bb", "gdd_bb_hobo", "budburst", "hobonum", "dvr"))
gddplot.dvr <- subset(gdd, select=c("provenance.lat", "fs.count", "spp", "gdd_dvr", "gdd_dvr_hobo", "budburst", "hobonum", "dvr"))
gddplot.bb <- na.omit(gddplot.bb)
gddplot.dvr <- na.omit(gddplot.dvr)
gddplot.bb <- gather(gddplot.bb, "method", "gdd", -provenance.lat, -fs.count, -spp, -budburst, -hobonum, -dvr)
gddplot.dvr <- gather(gddplot.dvr, "method", "gdd", -provenance.lat, -fs.count, -spp, -budburst, -hobonum, -dvr)
gddplot.bb$method <- ifelse(gddplot.bb$method=="gdd_bb", gddplot.bb$method, gddplot.bb$hobonum)
gddplot.dvr$method <- ifelse(gddplot.dvr$method=="gdd_dvr", gddplot.dvr$method, gddplot.dvr$hobonum)
gddplot.bb$gddmean <- ave(gddplot.bb$gdd, gddplot.bb$spp, gddplot.bb$method)
gddplot.bb$gddsd <- ave(gddplot.bb$gdd, gddplot.bb$spp, gddplot.bb$method, FUN=sd)
gddplot.bb$ymin <- gddplot.bb$gddmean-gddplot.bb$gddsd
gddplot.bb$ymax <- gddplot.bb$gddmean+gddplot.bb$gddsd
gddplot.dvr$gddmean <- ave(gddplot.dvr$gdd, gddplot.dvr$spp, gddplot.dvr$method)
gddplot.dvr$gddsd <- ave(gddplot.dvr$gdd, gddplot.dvr$spp, gddplot.dvr$method, FUN=sd)
gddplot.dvr$ymin <- gddplot.dvr$gddmean-gddplot.dvr$gddsd
gddplot.dvr$ymax <- gddplot.dvr$gddmean+gddplot.dvr$gddsd
dvr.loggers <- ggplot(gddplot.dvr, aes(x=dvr, y=gdd, col=method, linetype=method)) + geom_point() +
geom_line() + scale_color_manual(name="Method", values=cols,
labels=c("Hobo #10", "Hobo #11",
"Hobo #12", "Hobo #14",
"Hobo #15", "Hobo #2",
"Hobo #3", "Hobo #4",
"Hobo #7", "Hobo #8",
"Hobo #9", "Weather Station")) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
#axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white")) +
xlab("Days from budburst to leafout") + ylab("Growing degree days") + guides(linetype=FALSE)
cols <- colorRampPalette(brewer.pal(11,"Set3"))(11)
cols <- c(cols, "black")
dvr.loggers <- ggplot(gddplot.dvr, aes(x=dvr, y=gdd, col=method, linetype=method)) + geom_point() +
geom_line() + scale_color_manual(name="Method", values=cols,
labels=c("Hobo #10", "Hobo #11",
"Hobo #12", "Hobo #14",
"Hobo #15", "Hobo #2",
"Hobo #3", "Hobo #4",
"Hobo #7", "Hobo #8",
"Hobo #9", "Weather Station")) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
#axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white")) +
xlab("Days from budburst to leafout") + ylab("Growing degree days") + guides(linetype=FALSE)
dvr.loggers
