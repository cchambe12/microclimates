#### And now between methods...
badspp <- c("Carya glabra", "Carya ovata","Populus deltoides",
"Viburnum nudum")
bball.method <- bball.sub[!(bball.sub$species.name%in%badspp),]
bball.method$type <- ifelse(bball.method$method==1, "Weather Station", "Hobo Logger")
bball.method$codegdd <- reorder(bball.method$species.name, bball.method$gdd_bb)
#cols <- colorRampPalette(brewer.pal(3,"Dark2"))(2)
cols <- viridis_pal(option="viridis")(3)
gddcomparebb <- ggplot(bball.method, aes(x=codegdd, y=gdd_bb, fill=type)) +
geom_boxplot() +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_fill_manual(name="Site", values=cols,
labels=c("Hobo Logger", "Weather Station")) + coord_cartesian(expand=0, ylim=c(0,700))
pdf(file.path("~/Documents/git/microclimates/analyses/figures/", "gdd_comparemethods.pdf"),
width = 8, height = 6)
gddcomparebb
dev.off()
#cols <- colorRampPalette(brewer.pal(3,"Dark2"))(2)
cols <- viridis_pal(option="plasma")(2)
gddcomparebb <- ggplot(bball.site, aes(x=species.name, y=gdd_bb, fill=type)) +
geom_boxplot() +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_fill_manual(name="Site", values=cols,
labels=c("Harvard Forest", "Treespotters")) + coord_cartesian(expand=c(0,0), ylim=c(0,700))
pdf(file.path("~/Documents/git/microclimates/analyses/figures/", "gdd_sitecompare_boxplot.pdf"),
width = 8, height = 6)
gddcomparebb
dev.off()
gddcomparebb <- ggplot(bball.site, aes(x=species.name, y=gdd_bb, fill=type)) +
geom_boxplot() +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_fill_manual(name="Site", values=cols,
labels=c("Harvard Forest", "Treespotters")) + coord_cartesian(expand=0, ylim=c(0,700))
pdf(file.path("~/Documents/git/microclimates/analyses/figures/", "gdd_sitecompare_boxplot.pdf"),
width = 8, height = 6)
gddcomparebb
dev.off()
#cols <- colorRampPalette(brewer.pal(3,"Dark2"))(2)
cols <- viridis_pal(option="plasma")(3)
gddcomparebb <- ggplot(bball.site, aes(x=species.name, y=gdd_bb, fill=type)) +
geom_boxplot() +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_fill_manual(name="Site", values=cols,
labels=c("Harvard Forest", "Treespotters")) + coord_cartesian(expand=0, ylim=c(0,700))
pdf(file.path("~/Documents/git/microclimates/analyses/figures/", "gdd_sitecompare_boxplot.pdf"),
width = 8, height = 6)
gddcomparebb
dev.off()
gddcomparebb <- ggplot(bball.site, aes(x=species.name, y=gdd_bb, fill=type)) +
geom_boxplot() +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_fill_manual(name="Site", values=cols,
labels=c("Arnold Arboretum", "Harvard Forest")) + coord_cartesian(expand=0, ylim=c(0,700))
pdf(file.path("~/Documents/git/microclimates/analyses/figures/", "gdd_sitecompare_boxplot.pdf"),
width = 8, height = 6)
gddcomparebb
dev.off()
gddcomparebb <- ggplot(bball.site, aes(x=codegdd, y=gdd_bb, fill=type)) +
geom_boxplot() +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_fill_manual(name="Site", values=cols,
labels=c("Arnold Arboretum", "Harvard Forest")) + coord_cartesian(expand=0, ylim=c(0,700))
pdf(file.path("~/Documents/git/microclimates/analyses/figures/", "gdd_sitecompare_boxplot.pdf"),
width = 8, height = 6)
gddcomparebb
dev.off()
#### And finally, we want to plot the interaction between methods...
bball.site$methodtype <- ifelse(bball.site$method==1, "Weather Station", "Hobo Logger")
#cols <- colorRampPalette(brewer.pal(3,"Dark2"))(2)
cols <- viridis_pal(option="plasma")(4)
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, col=type)) +
geom_line() +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_color_manual(name="Site", values=cols,
labels=c("Arnold Arboretum", "Harvard Forest")) + coord_cartesian(expand=0, ylim=c(0,700))
pdf(file.path("~/Documents/git/microclimates/analyses/figures/", "gdd_comparemethodsandsites.pdf"),
width = 8, height = 6)
gddcomparebb
dev.off()
View(bball.site)
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, col=type)) +
geom_line(aes(x=methodtype, y=gdd_bb, col=type)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_color_manual(name="Site", values=cols,
labels=c("Arnold Arboretum", "Harvard Forest")) + coord_cartesian(expand=0, ylim=c(0,700))
quartz()
gddcomparebb
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, col=type, group=type)) +
geom_line(aes(x=methodtype, y=gdd_bb, col=type, group=type)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_color_manual(name="Site", values=cols,
labels=c("Arnold Arboretum", "Harvard Forest")) + coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, group=type)) +
geom_line(aes(x=methodtype, y=gdd_bb, group=type)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_color_manual(name="Site", values=cols,
labels=c("Arnold Arboretum", "Harvard Forest")) +
coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, col=type, group=type)) +
geom_line(aes(x=methodtype, y=gdd_bb, col=type, group=type)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_color_manual(name="Site", values=cols,
labels=c("Arnold Arboretum", "Harvard Forest")) +
coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, group=type)) +
geom_line(aes(x=methodtype, y=gdd_bb, col=type, group=type)) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
#legend.position = "none",
axis.text.x = element_text(angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_color_manual(name="Site", values=cols,
labels=c("Arnold Arboretum", "Harvard Forest")) +
coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb
#cols <- colorRampPalette(brewer.pal(3,"Dark2"))(2)
cols <- viridis_pal(option="plasma")(3)
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, group=type)) +
geom_line(aes(x=methodtype, y=gdd_bb, col=type, group=type), se=TRUE) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_color_manual(name="Site", values=cols,
labels=c("Arnold \nArboretum", "Harvard \nForest")) +
coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, group=type)) +
geom_smooth(aes(x=methodtype, y=gdd_bb, col=type, group=type), se=TRUE) +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_color_manual(name="Site", values=cols,
labels=c("Arnold \nArboretum", "Harvard \nForest")) +
coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb
warnings()
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, group=type)) +
geom_smooth(aes(x=methodtype, y=gdd_bb, col=type, group=type), se=TRUE, method="lm") +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_color_manual(name="Site", values=cols,
labels=c("Arnold \nArboretum", "Harvard \nForest")) +
coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, group=type)) +
geom_smooth(aes(x=methodtype, y=gdd_bb, col=type, group=type, se=type), se=TRUE, method="lm") +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_color_manual(name="Site", values=cols,
labels=c("Arnold \nArboretum", "Harvard \nForest")) +
coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, group=type, fill=type)) +
geom_smooth(aes(x=methodtype, y=gdd_bb, fill=type, group=type, se=type), se=TRUE, method="lm") +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_color_manual(name="Site", values=cols,
labels=c("Arnold \nArboretum", "Harvard \nForest")) +
coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, group=type, fill=type)) +
geom_smooth(aes(x=methodtype, y=gdd_bb, fill=type, group=type), se=TRUE, method="lm") +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_fill_manual(name="Site", values=cols,
labels=c("Arnold \nArboretum", "Harvard \nForest")) +
coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, group=type, fill=type)) +
geom_smooth(aes(x=methodtype, y=gdd_bb, fill=type, group=type), col="black", se=TRUE, method="lm") +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_fill_manual(name="Site", values=cols,
labels=c("Arnold \nArboretum", "Harvard \nForest")) +
coord_cartesian(expand=0, ylim=c(0,700))
#cols <- colorRampPalette(brewer.pal(3,"Dark2"))(2)
cols <- viridis_pal(option="plasma")(2)
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, group=type, fill=type)) +
geom_smooth(aes(x=methodtype, y=gdd_bb, fill=type, group=type), col="black", se=TRUE, method="lm") +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_fill_manual(name="Site", values=cols,
labels=c("Arnold \nArboretum", "Harvard \nForest")) +
coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb
#cols <- colorRampPalette(brewer.pal(3,"Dark2"))(2)
cols <- viridis_pal(option="plasma")(3)
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, group=type, fill=type)) +
geom_smooth(aes(x=methodtype, y=gdd_bb, fill=type, group=type), col="black", se=TRUE, method="lm") +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_fill_manual(name="Site", values=cols,
labels=c("Arnold \nArboretum", "Harvard \nForest")) +
coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb
#### And finally, we want to plot the interaction between methods...
bball.site$methodtype <- ifelse(bball.site$method==1, "Weather \nStation", "Hobo \nLogger")
#cols <- colorRampPalette(brewer.pal(3,"Dark2"))(2)
cols <- viridis_pal(option="magma")(3)
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, group=type, fill=type)) +
geom_smooth(aes(x=methodtype, y=gdd_bb, fill=type, group=type), col="black", se=TRUE, method="lm") +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_fill_manual(name="Site", values=cols,
labels=c("Arnold Arboretum", "Harvard Forest")) +
coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb
#cols <- colorRampPalette(brewer.pal(3,"Dark2"))(2)
cols <- viridis_pal(option="magma")(2)
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, group=type, fill=type)) +
geom_smooth(aes(x=methodtype, y=gdd_bb, fill=type, group=type), col="black", se=TRUE, method="lm") +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_fill_manual(name="Site", values=cols,
labels=c("Arnold Arboretum", "Harvard Forest")) +
coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb
#cols <- colorRampPalette(brewer.pal(3,"Dark2"))(2)
cols <- viridis_pal(option="viridis")(3)
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, group=type, fill=type)) +
geom_smooth(aes(x=methodtype, y=gdd_bb, fill=type, group=type), col=c("black", "grey"), se=TRUE, method="lm") +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_fill_manual(name="Site", values=cols,
labels=c("Arnold Arboretum", "Harvard Forest")) +
coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb
#cols <- colorRampPalette(brewer.pal(3,"Dark2"))(2)
cols <- viridis_pal(option="viridis")(3)
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, group=type, fill=type)) +
geom_smooth(aes(x=methodtype, y=gdd_bb, fill=type, group=type), col="grey", se=TRUE, method="lm") +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_fill_manual(name="Site", values=cols,
labels=c("Arnold Arboretum", "Harvard Forest")) +
coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, group=type, fill=type)) +
geom_ribbon(stat='smooth', method = "lm", se=TRUE, alpha=1,
aes(fill = type, group = type)) +
geom_line(stat='smooth', method = "lm", alpha=1, col="black") +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_fill_manual(name="Site", values=cols,
labels=c("Arnold Arboretum", "Harvard Forest")) +
coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb
#### And finally, we want to plot the interaction between methods...
bball.site$methodtype <- ifelse(bball.site$method==1, "\nWeather \nStation", "\nHobo \nLogger")
gddcomparebb <- ggplot(bball.site, aes(x=methodtype, y=gdd_bb, group=type, fill=type)) +
geom_ribbon(stat='smooth', method = "lm", se=TRUE, alpha=1,
aes(fill = type, group = type)) +
geom_line(stat='smooth', method = "lm", alpha=1, col="black") +
theme(panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.text.align = 0,
legend.key = element_rect(colour = "transparent", fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 1, "cm")) +
xlab("") +
ylab("Growing degree days to budburst") +
scale_fill_manual(name="Site", values=cols,
labels=c("Arnold Arboretum", "Harvard Forest")) +
coord_cartesian(expand=0, ylim=c(0,700))
gddcomparebb
pdf(file.path("~/Documents/git/microclimates/analyses/figures/", "gdd_comparemethodsandsites.pdf"),
width = 8, height = 6)
gddcomparebb
dev.off()
# housekeeping
rm(list=ls())
options(stringsAsFactors = FALSE)
#### Questions to address:
## Compare GDDs between hobo loggers and weather station data
# 1) GDDlo ~ 1 + (1|species) - do once for HF weather station, once for hobo logger and repeat for Arboretum
# Compare urban effect using weather station data and then hobo logger data
# 2) GDDlo ~ urban + (urban|species) - do once with weather station data and once with hobo logger data
## Let's start with Question 1 first...
library(bayesplot) ## for plotting
library(egg) ## for plotting
library(shinystan)
library(rstanarm)
library(rstan)
library(brms)
library(RColorBrewer)
library(viridis)
library(dplyr)
## Let's load some real data to check out.
setwd("~/Documents/git/microclimates/analyses/")
figpath <- "figures"
figpathmore <- "ws_method_urb_real"
source("source/microurban_muplot.R")
#source("source/microurban_phylo_muplot.R")
# Set up colors
cols <- adjustcolor("indianred3", alpha.f = 0.3)
my.pal <-rep(viridis_pal(option="viridis")(9),2)
#my.pal <- rep(brewer.pal(n = 8, name = "Dark2"), 3)
#my.pal <- my.pal[my.pal!=c("#FFFFBF", "#FEE08B", "#E6F598")]
# display.brewer.all()
my.pch <- rep(15:18, each=10)
alphahere = 0.4
if(figpathmore=="ws_urb" | figpathmore=="ws_phylo_urb"){
ws_urb <- read.csv("output/clean_gdd_bbanddvr.csv")
ws_urb$species <- ifelse(ws_urb$genus=="Acer" & ws_urb$species=="rubra", "rubrum", ws_urb$species)
ws_urb$urban <- NA
ws_urb$urban <- ifelse(ws_urb$type=="Harvard Forest", 0, ws_urb$urban)
ws_urb$urban <- ifelse(ws_urb$type=="Treespotters", 1, ws_urb$urban)
ws_urb <- ws_urb[(ws_urb$year>=2019),]
ws_urb.stan <- subset(ws_urb, select=c(gdd_bb, urban, genus, species))
ws_urb.stan <- ws_urb.stan[(complete.cases(ws_urb.stan)),]
ws_urb.stan$spp <- paste(ws_urb.stan$genus, ws_urb.stan$species, sep="_")
ws_urb.stan <- ws_urb.stan[(ws_urb.stan$gdd_bb<=1000),]
} else if(figpathmore=="hobo_urb" | figpathmore=="hobo_phylo_urb"){
hobo_urb <- read.csv("output/clean_gdd_bbanddvr_hobo.csv")
hobo_urb$species <- ifelse(ws_urb$genus=="Acer" & ws_urb$species=="rubra", "rubrum", ws_urb$species)
hobo_urb$urban <- NA
hobo_urb$urban <- ifelse(hobo_urb$type=="Harvard Forest", 0, hobo_urb$urban)
hobo_urb$urban <- ifelse(hobo_urb$type=="Treespotters", 1, hobo_urb$urban)
hobo_urb <- hobo_urb[(hobo_urb$year>=2019),]
hobo_urb.stan <- subset(hobo_urb, select=c(gdd_bb, urban, genus, species))
hobo_urb.stan <- hobo_urb.stan[(complete.cases(hobo_urb.stan)),]
hobo_urb.stan$spp <- paste(hobo_urb.stan$genus, hobo_urb.stan$species, sep="_")
hobo_urb.stan <- hobo_urb.stan[(hobo_urb.stan$gdd_bb<=1000),]
}
# Load fitted stan model: no interactions
#load("stan/hobo_urban_mod.Rdata")
#load("stan/ws_urban_mod.Rdata")
#load("stan/wsall_urban_mod.Rdata")
#load("stan/ws_phylomod_urban.Rdata")
load("stan/urbmethod_inter.Rdata")
use.stan=TRUE
if(use.stan==TRUE){
sumer.ws <- summary(urbmethod)$summary
sumer.ws[grep("mu_", rownames(sumer.ws)),]
unique(bball.stan$spp) # numbers are alphabetical
sort(unique(bball.stan$spp))
# m1.bb <- m2l.ni
modelhere <- urbmethod
muplotfx(modelhere, "", 8, 8, c(0,3), c(-150, 50), 60, 2)
}
# Load fitted stan model: no interactions
#load("stan/hobo_urban_mod.Rdata")
#load("stan/ws_urban_mod.Rdata")
#load("stan/wsall_urban_mod.Rdata")
#load("stan/ws_phylomod_urban.Rdata")
load("stan/urbmethod_inter.Rdata")
use.stan=TRUE
if(use.stan==TRUE){
ws <- read.csv("output/clean_gdd_chill_bbanddvr.csv")
ws$method <- 1
ws_urb <- subset(ws, select=c("id", "type", "gdd_bb", "method", "year", "genus", "species", "utah"))
ws_urb <- ws_urb[(ws_urb$type!="Common Garden"),]
hobo <- read.csv("output/clean_gdd_chill_bbanddvr_hobo.csv")
hobo$method <- 0
hobo_urb <- subset(hobo, select=c("id", "type", "gdd_bb", "method", "year", "genus", "species", "utah"))
hobo_urb <- hobo_urb[(hobo_urb$type!="Common Garden"),]
bball <- dplyr::full_join(ws_urb, hobo_urb)
bball$urban <- NA
bball$urban <- ifelse(bball$type=="Harvard Forest", 0, bball$urban)
bball$urban <- ifelse(bball$type=="Treespotters", 1, bball$urban)
bball.stan <- bball[(bball$year=="2019"),]
bball.stan <- subset(bball, select=c(gdd_bb, urban, method, genus, species))
bball.stan <- bball.stan[(complete.cases(bball.stan)),]
bball.stan <- bball.stan[!is.na(bball.stan$gdd_bb),]
bball.stan$spp <- paste(bball.stan$genus, bball.stan$species, sep="_")
bball.stan <- bball.stan[(bball.stan$gdd_bb<=1000),]
sumer.ws <- summary(urbmethod)$summary
sumer.ws[grep("mu_", rownames(sumer.ws)),]
unique(bball.stan$spp) # numbers are alphabetical
sort(unique(bball.stan$spp))
# m1.bb <- m2l.ni
modelhere <- urbmethod
muplotfx(modelhere, "", 8, 8, c(0,3), c(-150, 50), 60, 2)
}
# Load fitted stan model: no interactions
#load("stan/hobo_urban_mod.Rdata")
#load("stan/ws_urban_mod.Rdata")
#load("stan/wsall_urban_mod.Rdata")
#load("stan/ws_phylomod_urban.Rdata")
load("stan/urbmethod_inter.Rdata")
muplotfx(modelhere, "", 6, 6, c(0,3), c(-150, 50), 60, 2)
muplotfx(modelhere, "", , 7, c(0,3), c(-150, 50), 60, 3)
muplotfx(modelhere, "", 7, 7, c(0,3), c(-150, 50), 60, 3)
