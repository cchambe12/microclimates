#    col=cols[as.factor(bball$method)], ylab="GDD accuracy", xaxt="none",xlab="")
plot((as.numeric(as.factor(bball$type))), c(abs(as.numeric(bball$gdd_accuracy_wsws)),
abs(as.numeric(bball$gdd_accuracy_wshobo))),
col=cols2[1:2], ylab="GDD accuracy", xaxt="none",xlab="")
abs(as.numeric(bball$gdd_accuracy_wsws))
c(abs(as.numeric(bball$gdd_accuracy_wsws[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_wshobo[bball$method=="ws"])))
c(abs(as.numeric(bball$gdd_accuracy_hobows[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_hobohobo[bball$method=="ws"])))
#plot(as.numeric(as.factor(bball$type)), as.numeric(bball$gdd_accuracy),
#    col=cols[as.factor(bball$method)], ylab="GDD accuracy", xaxt="none",xlab="")
plot((as.numeric(as.factor(bball$type))), c(abs(as.numeric(bball$gdd_accuracy_wsws[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_wshobo[bball$method=="ws"]))),
col=cols2[1:2], ylab="GDD accuracy", xaxt="none",xlab="")
points((as.numeric(as.factor(bball$type))+0.02), c(abs(as.numeric(bball$gdd_accuracy_hobows[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_hobohobo[bball$method=="ws"]))),
col=cols2[as.factor(meangddbyspp$method)])
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
legend(0, -20, sort(unique(gsub("_", " ", bball$method))), pch=19,
col=cols[as.factor(bball$method)],
cex=1, bty="n")
#plot(as.numeric(as.factor(bball$type)), as.numeric(bball$gdd_accuracy),
#    col=cols[as.factor(bball$method)], ylab="GDD accuracy", xaxt="none",xlab="")
plot((as.numeric(as.factor(bball$type))), c(abs(as.numeric(bball$gdd_accuracy_wshobo[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_wsws[bball$method=="ws"]))),
col=cols2[1:2], ylab="GDD accuracy", xaxt="none",xlab="")
points((as.numeric(as.factor(bball$type))+0.02), c(abs(as.numeric(bball$gdd_accuracy_hobohobo[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_hobows[bball$method=="ws"]))),
col=cols2[as.factor(meangddbyspp$method)])
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
legend(0, -20, sort(unique(gsub("_", " ", bball$method))), pch=19,
col=cols[as.factor(bball$method)],
cex=1, bty="n")
bball$gdd_accuracy_ws <- ifelse(bball$method=="ws", (bball$meangdd_ws - bball$mingdd_ws), (bball$meangdd_ws - bball$mingdd_hobo))
#bball$gdd_accuracy_wshobo <- bball$meangdd_ws - bball$mingdd_hobo
bball$gdd_accuracy_hobo <- ifelse(bball$method=="ws", (bball$meangdd_hobo - bball$mingdd_ws), (bball$meangdd_hobo - bball$mingdd_hobo))
#plot(as.numeric(as.factor(bball$type)), as.numeric(bball$gdd_accuracy),
#    col=cols[as.factor(bball$method)], ylab="GDD accuracy", xaxt="none",xlab="")
plot((as.numeric(as.factor(bball$type))), c(abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="ws"]))),
col=cols2[1:2], ylab="GDD accuracy", xaxt="none",xlab="")
points((as.numeric(as.factor(bball$type))+0.02), c(abs(as.numeric(bball$gdd_accuracy_hobo[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_hobo[bball$method=="ws"]))),
col=cols2[as.factor(meangddbyspp$method)])
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
legend(0, -20, sort(unique(gsub("_", " ", bball$method))), pch=19,
col=cols[as.factor(bball$method)],
cex=1, bty="n")
bball$gdd_accuracy_ws <- ifelse(bball$method=="ws", (bball$meangdd_ws - bball$mingdd_ws), (bball$meangdd_ws - bball$mingdd_hobo))
#bball$gdd_accuracy_wshobo <- bball$meangdd_ws - bball$mingdd_hobo
bball$gdd_accuracy_hobo <- ifelse(bball$method=="ws", (bball$meangdd_hobo - bball$mingdd_ws), (bball$meangdd_hobo - bball$mingdd_hobo))
c(abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="ws"])))
abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="hobo"]))
range(abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="hobo"])))
range(abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="ws"])))
#plot(as.numeric(as.factor(bball$type)), as.numeric(bball$gdd_accuracy),
#    col=cols[as.factor(bball$method)], ylab="GDD accuracy", xaxt="none",xlab="")
plot((as.numeric(as.factor(bball$type))), c(abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="ws"]))),
col=cols2[1:2], ylab="GDD accuracy", xaxt="none",xlab="")
c(abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="ws"])))
(as.numeric(as.factor(bball$type)))
#plot(as.numeric(as.factor(bball$type)), as.numeric(bball$gdd_accuracy),
#    col=cols[as.factor(bball$method)], ylab="GDD accuracy", xaxt="none",xlab="")
plot((as.numeric(as.factor(bball$type))), as.numeric(bball$gdd_accuracy_ws),
col=cols2[1:2], ylab="GDD accuracy", xaxt="none",xlab="")
points((as.numeric(as.factor(bball$type))+0.02), as.numeric(bball$gdd_accuracy_hobo),
col=cols2[as.factor(meangddbyspp$method)])
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
legend(0, -20, sort(unique(gsub("_", " ", bball$method))), pch=19,
col=cols[as.factor(bball$method)],
cex=1, bty="n")
#plot(as.numeric(as.factor(bball$type)), as.numeric(bball$gdd_accuracy),
#    col=cols[as.factor(bball$method)], ylab="GDD accuracy", xaxt="none",xlab="")
plot((as.numeric(as.factor(bball$type))), abs(as.numeric(bball$gdd_accuracy_ws)),
col=cols2[1:2], ylab="GDD accuracy", xaxt="none",xlab="")
points((as.numeric(as.factor(bball$type))+0.02), abs(as.numeric(bball$gdd_accuracy_hobo)),
col=cols2[as.factor(meangddbyspp$method)])
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
legend(0, -20, sort(unique(gsub("_", " ", bball$method))), pch=19,
col=cols[as.factor(bball$method)],
cex=1, bty="n")
#plot(as.numeric(as.factor(bball$type)), as.numeric(bball$gdd_accuracy),
#    col=cols[as.factor(bball$method)], ylab="GDD accuracy", xaxt="none",xlab="")
plot((as.numeric(as.factor(bball$type))), c(abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_hobo[bball$method=="ws"]))),
col=cols2[1:2], ylab="GDD accuracy", xaxt="none",xlab="")
#points((as.numeric(as.factor(bball$type))+0.02), abs(as.numeric(bball$gdd_accuracy_hobo)),
#      col=cols2[as.factor(meangddbyspp$method)])
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
legend(0, -20, sort(unique(gsub("_", " ", bball$method))), pch=19,
col=cols[as.factor(bball$method)],
cex=1, bty="n")
#plot(as.numeric(as.factor(bball$type)), as.numeric(bball$gdd_accuracy),
#    col=cols[as.factor(bball$method)], ylab="GDD accuracy", xaxt="none",xlab="")
plot(c(as.numeric(as.factor(bball$type[bball$method=="hobo"])),
as.numeric(as.factor(bball$type[bball$method=="ws"]))),
c(abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_hobo[bball$method=="ws"]))),
col=cols2[1:2], ylab="GDD accuracy", xaxt="none",xlab="")
#points((as.numeric(as.factor(bball$type))+0.02), abs(as.numeric(bball$gdd_accuracy_hobo)),
#      col=cols2[as.factor(meangddbyspp$method)])
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
legend(0, -20, sort(unique(gsub("_", " ", bball$method))), pch=19,
col=cols[as.factor(bball$method)],
cex=1, bty="n")
c(as.numeric(as.factor(bball$type[bball$method=="hobo"])),
as.numeric(as.factor(bball$type[bball$method=="ws"])))
as.numeric(as.factor(bball$type[bball$method=="ws"])))
as.numeric(as.factor(bball$type[bball$method=="ws"]))
bball$type[bball$method=="hobo"]
xtext <- seq(0, 1, by=1)
#plot(as.numeric(as.factor(bball$type)), as.numeric(bball$gdd_accuracy),
#    col=cols[as.factor(bball$method)], ylab="GDD accuracy", xaxt="none",xlab="")
plot(c(bball$type[bball$method=="hobo"],
bball$type[bball$method=="ws"]),
c(abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_hobo[bball$method=="ws"]))),
col=cols2[1:2], ylab="GDD accuracy", xaxt="none",xlab="")
#points((as.numeric(as.factor(bball$type))+0.02), abs(as.numeric(bball$gdd_accuracy_hobo)),
#      col=cols2[as.factor(meangddbyspp$method)])
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
legend(0, -20, sort(unique(gsub("_", " ", bball$method))), pch=19,
col=cols[as.factor(bball$method)],
cex=1, bty="n")
#plot(as.numeric(as.factor(bball$type)), as.numeric(bball$gdd_accuracy),
#    col=cols[as.factor(bball$method)], ylab="GDD accuracy", xaxt="none",xlab="")
plot(c(bball$type[bball$method=="hobo"],
bball$type[bball$method=="ws"]),
c(abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_hobo[bball$method=="ws"]))), col=cols[1:2], ylab="GDD accuracy", xaxt="none",xlab="")
#points((as.numeric(as.factor(bball$type))+0.02), abs(as.numeric(bball$gdd_accuracy_hobo)),
#      col=cols2[as.factor(meangddbyspp$method)])
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
legend(0, -20, sort(unique(gsub("_", " ", bball$method))), pch=19,
col=cols[1:2],
cex=1, bty="n")
cols[1:2]
#plot(as.numeric(as.factor(bball$type)), as.numeric(bball$gdd_accuracy),
#    col=cols[as.factor(bball$method)], ylab="GDD accuracy", xaxt="none",xlab="")
plot(c(bball$type[bball$method=="hobo"],
bball$type[bball$method=="ws"]),
c(abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_hobo[bball$method=="ws"]))), col=cols[1:2],
ylab="GDD accuracy", xaxt="none",xlab="")
#plot(as.numeric(as.factor(bball$type)), as.numeric(bball$gdd_accuracy),
#    col=cols[as.factor(bball$method)], ylab="GDD accuracy", xaxt="none",xlab="")
plot(c((bball$type[bball$method=="hobo"]+1),
(bball$type[bball$method=="ws"]+1)),
c(abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_hobo[bball$method=="ws"]))), col=cols[1:2],
ylab="GDD accuracy", xaxt="none",xlab="")
#points((as.numeric(as.factor(bball$type))+0.02), abs(as.numeric(bball$gdd_accuracy_hobo)),
#      col=cols2[as.factor(meangddbyspp$method)])
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
xtext <- seq(1, 2, by=1)
#plot(as.numeric(as.factor(bball$type)), as.numeric(bball$gdd_accuracy),
#    col=cols[as.factor(bball$method)], ylab="GDD accuracy", xaxt="none",xlab="")
plot(c((bball$type[bball$method=="hobo"]+1),
(bball$type[bball$method=="ws"]+1)),
c(abs(as.numeric(bball$gdd_accuracy_ws[bball$method=="hobo"])),
abs(as.numeric(bball$gdd_accuracy_hobo[bball$method=="ws"]))), col=cols[1:2],
ylab="GDD accuracy", xaxt="none",xlab="")
#points((as.numeric(as.factor(bball$type))+0.02), abs(as.numeric(bball$gdd_accuracy_hobo)),
#      col=cols2[as.factor(meangddbyspp$method)])
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
legend(0, -20, sort(unique(gsub("_", " ", bball$method))), pch=19,
col=cols[1:2],
cex=1, bty="n")
bball$gdd_accuracy_raw <- ifelse(bball$method=="ws", (bball$meangdd_hobo - bball$mingdd_ws), (bball$meangdd_ws - bball$mingdd_hobo))
#plot(as.numeric(as.factor(bball$type)), as.numeric(bball$gdd_accuracy),
#    col=cols[as.factor(bball$method)], ylab="GDD accuracy", xaxt="none",xlab="")
plot(as.numeric(as.factor(bball$type)),
abs(as.numeric(bball$gdd_accuracy_ws)), col=cols[1:2],
ylab="GDD accuracy", xaxt="none",xlab="")
#points((as.numeric(as.factor(bball$type))+0.02), abs(as.numeric(bball$gdd_accuracy_hobo)),
#      col=cols2[as.factor(meangddbyspp$method)])
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
legend(0, -20, sort(unique(gsub("_", " ", bball$method))), pch=19,
col=cols[1:2],
cex=1, bty="n")
#plot(as.numeric(as.factor(bball$type)), as.numeric(bball$gdd_accuracy),
#    col=cols[as.factor(bball$method)], ylab="GDD accuracy", xaxt="none",xlab="")
plot(as.numeric(as.factor(bball$type)),
abs(as.numeric(bball$gdd_accuracy_raw)), col=cols[1:2],
ylab="GDD accuracy", xaxt="none",xlab="")
#points((as.numeric(as.factor(bball$type))+0.02), abs(as.numeric(bball$gdd_accuracy_hobo)),
#      col=cols2[as.factor(meangddbyspp$method)])
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
legend(0, -20, sort(unique(gsub("_", " ", bball$method))), pch=19,
col=cols[1:2],
cex=1, bty="n")
pdf("figures/gddaccuracy_noisyhobo.pdf", width=6, height=4)
cols2 <- viridis_pal(option="inferno")(3)
plot(as.numeric(as.factor(meangddbyspp$method)), as.numeric(meangddbyspp$sigma),
col=cols[as.factor(meangddbyspp$method)], ylab="GDD accuracy", xaxt="none",xlab="")
points((as.numeric(as.factor(meangddbyspp$method))+0.02), as.numeric(meangddbyspp$sigma_raw),
col=cols2[as.factor(meangddbyspp$method)])
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
legend(0, -20, sort(unique(gsub("_", " ", meangddbyspp$method))), pch=19,
col=cols[as.factor(meangddbyspp$method)],
cex=1, bty="n")
dev.off()
pdf("figures/gddaccuracy_noisyhobo.pdf", width=6, height=4)
cols2 <- viridis_pal(option="inferno")(4)
plot(as.numeric(as.factor(bball$type)),
abs(as.numeric(bball$gdd_accuracy_raw)), col=cols[1:2],
ylab="GDD accuracy", xaxt="none",xlab="")
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
legend(0, -20, sort(unique(gsub("_", " ", bball$method))), pch=19,
col=cols[1:2],
cex=1, bty="n")
dev.off()
gddbox<- ggplot(bball, aes(x=species, y=gdd, alpha=method)) + geom_boxplot(aes(alpha=as.factor(method), fill=as.factor(species), col=as.factor(species))) +
scale_fill_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_color_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic() +
ylab("Growing Degree Days") +# coord_cartesian(ylim=c(50,165)) +
scale_alpha_manual(name="Method", values=c(0.2, 0.7),
labels=c("hobo"="Hobo Logger", "ws"="Weather Station")) +
geom_point(aes(x=species, y=fstarspp), col="black") +
geom_point(aes(x=species, y=mingdd_ws), col="red")
guides(alpha=guide_legend(override.aes=list(fill=hcl(c(15,195),100,0,alpha=c(0.2,0.7)))), col=FALSE, fill=FALSE)
gddbox<- ggplot(bball, aes(x=species, y=gdd, alpha=method)) + geom_boxplot(aes(alpha=as.factor(method), fill=as.factor(species), col=as.factor(species))) +
scale_fill_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_color_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic() +
ylab("Growing Degree Days") +# coord_cartesian(ylim=c(50,165)) +
scale_alpha_manual(name="Method", values=c(0.2, 0.7),
labels=c("hobo"="Hobo Logger", "ws"="Weather Station")) +
geom_point(aes(x=species, y=fstarspp), col="black") +
geom_point(aes(x=species, y=mingdd_ws), col="red") +
guides(alpha=guide_legend(override.aes=list(fill=hcl(c(15,195),100,0,alpha=c(0.2,0.7)))), col=FALSE, fill=FALSE)
gddbox
gddbox<- ggplot(bball, aes(x=species, y=gdd, alpha=method)) + geom_boxplot(aes(alpha=as.factor(method), fill=as.factor(species), col=as.factor(species))) +
scale_fill_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_color_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic() +
ylab("Growing Degree Days") +# coord_cartesian(ylim=c(50,165)) +
scale_alpha_manual(name="Method", values=c(0.2, 0.7),
labels=c("hobo"="Hobo Logger", "ws"="Weather Station")) +
geom_point(aes(x=species, y=fstarspp), col="black") +
geom_jitter(aes(x=species, y=mingdd_ws), col="red") +
guides(alpha=guide_legend(override.aes=list(fill=hcl(c(15,195),100,0,alpha=c(0.2,0.7)))), col=FALSE, fill=FALSE)
gddbox
gddbox<- ggplot(bball, aes(x=species, y=gdd, alpha=method)) + geom_boxplot(aes(alpha=as.factor(method), fill=as.factor(species), col=as.factor(species))) +
scale_fill_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_color_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic() +
ylab("Growing Degree Days") +# coord_cartesian(ylim=c(50,165)) +
scale_alpha_manual(name="Method", values=c(0.2, 0.7),
labels=c("hobo"="Hobo Logger", "ws"="Weather Station")) +
geom_point(aes(x=species, y=fstarspp), col="black") +
geom_jitter(aes(x=species, y=ave(mingdd_ws, species)), col="red") +
guides(alpha=guide_legend(override.aes=list(fill=hcl(c(15,195),100,0,alpha=c(0.2,0.7)))), col=FALSE, fill=FALSE)
gddbox
gddbox<- ggplot(bball, aes(x=species, y=gdd, alpha=method)) + geom_boxplot(aes(alpha=as.factor(method), fill=as.factor(species), col=as.factor(species))) +
scale_fill_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_color_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic() +
ylab("Growing Degree Days") +# coord_cartesian(ylim=c(50,165)) +
scale_alpha_manual(name="Method", values=c(0.2, 0.7),
labels=c("hobo"="Hobo Logger", "ws"="Weather Station")) +
geom_point(aes(x=species, y=fstarspp), col="black") +
geom_jitter(aes(x=species, y=unique(ave(mingdd_ws, species))), col="red") +
guides(alpha=guide_legend(override.aes=list(fill=hcl(c(15,195),100,0,alpha=c(0.2,0.7)))), col=FALSE, fill=FALSE)
gddbox
gddbox<- ggplot(bball, aes(x=species, y=gdd, alpha=method)) + geom_boxplot(aes(alpha=as.factor(method), fill=as.factor(species), col=as.factor(species))) +
scale_fill_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_color_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic() +
ylab("Growing Degree Days") +# coord_cartesian(ylim=c(50,165)) +
scale_alpha_manual(name="Method", values=c(0.2, 0.7),
labels=c("hobo"="Hobo Logger", "ws"="Weather Station")) +
geom_point(aes(x=species, y=fstarspp), col="black") +
geom_point(aes(x=(species+0.1), y=mingdd_ws), col="red") +
guides(alpha=guide_legend(override.aes=list(fill=hcl(c(15,195),100,0,alpha=c(0.2,0.7)))), col=FALSE, fill=FALSE)
gddbox
gddbox<- ggplot(bball, aes(x=species, y=gdd, alpha=method)) + geom_boxplot(aes(alpha=as.factor(method), fill=as.factor(species), col=as.factor(species))) +
scale_fill_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_color_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic() +
ylab("Growing Degree Days") +# coord_cartesian(ylim=c(50,165)) +
scale_alpha_manual(name="Method", values=c(0.2, 0.7),
labels=c("hobo"="Hobo Logger", "ws"="Weather Station")) +
geom_point(aes(x=species, y=fstarspp), col="black") +
geom_point(aes(x=(species+0.1), y=mingdd_ws), col="red") +
geom_point(aes(x=(species+0.1), y=mingdd_hobo), col="green") +
guides(alpha=guide_legend(override.aes=list(fill=hcl(c(15,195),100,0,alpha=c(0.2,0.7)))), col=FALSE, fill=FALSE)
gddbox
gddbox<- ggplot(bball, aes(x=species, y=gdd, alpha=method)) + geom_boxplot(aes(alpha=as.factor(method), fill=as.factor(species), col=as.factor(species))) +
scale_fill_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_color_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic() +
ylab("Growing Degree Days") +# coord_cartesian(ylim=c(50,165)) +
scale_alpha_manual(name="Method", values=c(0.2, 0.7),
labels=c("hobo"="Hobo Logger", "ws"="Weather Station")) +
geom_point(aes(x=species, y=fstarspp), col="black") +
geom_point(aes(x=(species+0.1), y=mingdd_ws), col="red") +
geom_point(aes(x=(species-0.1), y=mingdd_hobo), col="green") +
guides(alpha=guide_legend(override.aes=list(fill=hcl(c(15,195),100,0,alpha=c(0.2,0.7)))), col=FALSE, fill=FALSE)
gddbox
pdf("figures/gddmethod_noisyhobo_boxplot.pdf", width=8, height=4)
gddbox
simsdat <- bbfunc("hobo", "hobo", 0, 20, 300, 50, 11, 4, 1, 0, 9, 2, -1, 0)
bball <- simsdat[[1]]
xtext <- seq(1, 3, by=1)
cols <-viridis_pal(option="viridis")(3)
xtext <- seq(1, 2, by=1)
### One thing I noticed is that the black dot, is consistently below the mean estimate of the weather station but varies strongly from the hobo logger...
## That consistent number relates the mean temperature, I think... let's see if we can come up with an equation
bball$meangdd <- ave(bball$gdd, bball$species, bball$method)
bball$fstarspp_raw <- ave(bball$gdd, bball$species)
bball$mingdd <- ave(bball$gdd, bball$species, bball$method, FUN=min)
bball$mingdd_ws <- NA
bball$mingdd_hobo <- NA
min_ws <- vector()
min_hobo <- vector()
for(i in 1:length(unique(bball$species))){ #i=2
min_ws <- bball$mingdd[bball$method=="ws" & bball$species==i]
bball$mingdd_ws[bball$species==i] <- min_ws
min_hobo <- bball$mingdd[bball$method=="hobo" & bball$species==i]
bball$mingdd_hobo[bball$species==i] <- min_hobo
}
bball$meangdd_ws <- NA
bball$meangdd_hobo <- NA
mean_ws <- vector()
mean_hobo <- vector()
for(i in 1:length(unique(bball$species))){ #i=2
mean_ws <- bball$meangdd[bball$method=="ws" & bball$species==i]
bball$meangdd_ws[bball$species==i] <- mean_ws
mean_hobo <- bball$meangdd[bball$method=="hobo" & bball$species==i]
bball$meangdd_hobo[bball$species==i] <- mean_hobo
}
bball$gdd_accuracy_raw <- ifelse(bball$method=="ws", (bball$meangdd_hobo - bball$mingdd_ws), (bball$meangdd_ws - bball$mingdd_hobo))
fstarrawfunc <- function(df){
hoboaccuracy <- max(df$meangdd_ws - df$mingdd_hobo) - min(df$meangdd_ws - df$mingdd_hobo)
wsaccuracy <- max(df$meangdd_hobo - df$mingdd_ws) - min(df$meangdd_hobo - df$mingdd_ws)
methodcheck <- hoboaccuracy - wsaccuracy
if(methodcheck<0){
df$fstar_raw <- df$mingdd_hbbo
} else{
df$fstar_raw <- df$mingdd_ws
}
return(df)
}
bball <- fstarrawfunc(bball)
View(bball)
simsdat <- bbfunc("hobo", "hobo", 0, 20, 300, 50, 11, 4, 1, 0, 9, 2, -1, 0)
bball <- simsdat[[1]]
xtext <- seq(1, 2, by=1)
cols <-viridis_pal(option="viridis")(3)
### One thing I noticed is that the black dot, is consistently below the mean estimate of the weather station but varies strongly from the hobo logger...
## That consistent number relates the mean temperature, I think... let's see if we can come up with an equation
bball$meangdd <- ave(bball$gdd, bball$species, bball$method)
bball$mingdd <- ave(bball$gdd, bball$species, bball$method, FUN=min)
bball$mingdd_ws <- NA
bball$mingdd_hobo <- NA
min_ws <- vector()
min_hobo <- vector()
for(i in 1:length(unique(bball$species))){ #i=2
min_ws <- bball$mingdd[bball$method=="ws" & bball$species==i]
bball$mingdd_ws[bball$species==i] <- min_ws
min_hobo <- bball$mingdd[bball$method=="hobo" & bball$species==i]
bball$mingdd_hobo[bball$species==i] <- min_hobo
}
bball$meangdd_ws <- NA
bball$meangdd_hobo <- NA
mean_ws <- vector()
mean_hobo <- vector()
for(i in 1:length(unique(bball$species))){ #i=2
mean_ws <- bball$meangdd[bball$method=="ws" & bball$species==i]
bball$meangdd_ws[bball$species==i] <- mean_ws
mean_hobo <- bball$meangdd[bball$method=="hobo" & bball$species==i]
bball$meangdd_hobo[bball$species==i] <- mean_hobo
}
fstarrawfunc <- function(df){
hoboaccuracy <- max(df$meangdd_ws - df$mingdd_hobo) - min(df$meangdd_ws - df$mingdd_hobo)
wsaccuracy <- max(df$meangdd_hobo - df$mingdd_ws) - min(df$meangdd_hobo - df$mingdd_ws)
methodcheck <- hoboaccuracy - wsaccuracy
if(methodcheck<0){
df$fstarspp_raw <- df$mingdd_hbbo
} else{
df$fstarspp_raw <- df$mingdd_ws
}
return(df)
}
bball <- fstarrawfunc(bball)
bball$gdd_accuracy_raw <- bball$gdd - bball$fstarspp_raw
pdf("figures/gddaccuracy_raw_noisyhobo.pdf", width=6, height=4)
cols2 <- viridis_pal(option="inferno")(4)
plot(as.numeric(as.factor(bball$type)),
abs(as.numeric(bball$gdd_accuracy_raw)), col=cols2[1:2],
ylab="GDD accuracy", xaxt="none",xlab="")
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
dev.off()
pdf("figures/gddaccuracy_raw_noisyhobo.pdf", width=6, height=4)
cols2 <- viridis_pal(option="inferno")(2)
plot(as.numeric(as.factor(bball$type)),
abs(as.numeric(bball$gdd_accuracy_raw)), col=cols2,
ylab="GDD accuracy", xaxt="none",xlab="")
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
dev.off()
cols2 <- viridis_pal(option="magma")(2)
plot(as.numeric(as.factor(bball$type)),
abs(as.numeric(bball$gdd_accuracy_raw)), col=cols2,
ylab="GDD accuracy", xaxt="none",xlab="")
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
dev.off()
pdf("figures/gddaccuracy_raw_noisyhobo.pdf", width=6, height=4)
cols2 <- viridis_pal(option="magma")(2)
plot(as.numeric(as.factor(bball$type)),
abs(as.numeric(bball$gdd_accuracy_raw)), col=cols2,
ylab="GDD accuracy", xaxt="none",xlab="")
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
dev.off()
pdf("figures/gddaccuracy_raw_noisyhobo.pdf", width=6, height=4)
cols2 <- viridis_pal(option="magma")(4)
plot(as.numeric(as.factor(bball$type)),
abs(as.numeric(bball$gdd_accuracy_raw)), col=cols2[1:2],
ylab="GDD accuracy", xaxt="none",xlab="")
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
dev.off()
cols2 <- viridis_pal(option="plasma")(4)
plot(as.numeric(as.factor(bball$type)),
abs(as.numeric(bball$gdd_accuracy_raw)), col=cols2[1:2],
ylab="GDD accuracy", xaxt="none",xlab="")
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
dev.off()
pdf("figures/gddaccuracy_raw_noisyhobo.pdf", width=6, height=4)
cols2 <- viridis_pal(option="plasma")(4)
plot(as.numeric(as.factor(bball$type)),
abs(as.numeric(bball$gdd_accuracy_raw)), col=cols2[1:2],
ylab="GDD accuracy", xaxt="none",xlab="")
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
dev.off()
pdf("figures/gddaccuracy_raw_noisyhobo.pdf", width=6, height=4)
plot(as.numeric(as.factor(bball$type)),
abs(as.numeric(bball$gdd_accuracy_raw)), col=cols[1:2],
ylab="GDD accuracy", xaxt="none",xlab="")
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
dev.off()
pdf("figures/gddmethod_noisyhobo_boxplot.pdf", width=8, height=4)
gddbox
dev.off()
pdf("figures/gddmethod_noisyhobo_boxplot.pdf", width=6, height=6)
gddbox
dev.off()
pdf("figures/gddmethod_noisyhobo_boxplot.pdf", width=6, height=4)
gddbox
dev.off()
gddbox<- ggplot(bball, aes(x=species, y=gdd, alpha=method)) + geom_boxplot(aes(alpha=as.factor(method), fill=as.factor(species), col=as.factor(species))) +
scale_fill_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_color_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic() +
ylab("Growing Degree Days") +# coord_cartesian(ylim=c(50,165)) +
scale_alpha_manual(name="Method", values=c(0.2, 0.7),
labels=c("hobo"="Hobo Logger", "ws"="Weather Station")) +
geom_point(aes(x=species, y=fstarspp), col="black") +
geom_point(aes(x=(species+0.1), y=mingdd_ws), col="red") +
guides(alpha=guide_legend(override.aes=list(fill=hcl(c(15,195),100,0,alpha=c(0.2,0.7)))), col=FALSE, fill=FALSE)
pdf("figures/gddmethod_noisyhobo_boxplot.pdf", width=10, height=8)
gddbox
dev.off()
pdf("figures/gddmethod_noisyhobo_boxplot.pdf", width=10, height=6)
gddbox
dev.off()
pdf("figures/gddaccuracy_raw_noisyhobo.pdf", width=6, height=4)
plot(as.numeric(as.factor(bball$type)),
abs(as.numeric(bball$gdd_accuracy_raw)), col=cols[1:2],
ylab="Raw GDD accuracy", xaxt="none",xlab="")
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
dev.off()
pdf("figures/gddaccuracy_noisyhobo.pdf", width=6, height=4)
plot(as.numeric(as.factor(bball$type)), as.numeric(bball$gdd_accuracy),
col=cols[as.factor(bball$method)], ylab="GDD accuracy", xaxt="none",xlab="")
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
legend(0, -20, sort(unique(gsub("_", " ", bball$method))), pch=19,
col=cols[as.factor(bball$method)],
cex=1, bty="n")
dev.off()
pdf("figures/gddaccuracy_raw_noisyhobo.pdf", width=6, height=4)
plot(as.numeric(as.factor(bball$type)),
as.numeric(bball$gdd_accuracy_raw), col=cols[as.factor(bball$method)],
ylab="Raw GDD accuracy", xaxt="none",xlab="")
axis(side=1, at=xtext, labels = c("Hobo Logger", "Weather Station"))
dev.off()
gddbox<- ggplot(bball, aes(x=species, y=gdd, alpha=method)) + geom_boxplot(aes(alpha=as.factor(method), fill=as.factor(species), col=as.factor(species))) +
scale_fill_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_color_manual(name="Species", values=spcols, labels=sort(unique(bball$species))) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic() + xlab("") +
ylab("Growing Degree Days") +# coord_cartesian(ylim=c(50,165)) +
scale_alpha_manual(name="Method", values=c(0.2, 0.7),
labels=c("hobo"="Hobo Logger", "ws"="Weather Station")) +
geom_point(aes(x=species, y=fstarspp), col="black") +
#geom_point(aes(x=(species+0.1), y=mingdd_ws), col="red") +
guides(alpha=guide_legend(override.aes=list(fill=hcl(c(15,195),100,0,alpha=c(0.2,0.7)))), col=FALSE, fill=FALSE)
pdf("figures/gddmethod_noisyhobo_boxplot_nominws.pdf", width=10, height=6)
gddbox
dev.off()
