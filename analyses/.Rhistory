foo <- foo[(foo$sum>5),]
foo$sum <- c(0, sapply(2:nrow(foo), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo <- foo[(foo$sum>5),]
foo$sum <- c(0, sapply(2:nrow(foo), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo <- foo[(foo$sum>5),]
foo$sum <- ave(foo$A_Photosynthesis, foo$unique_leaf, FUN=c(0, sapply(2:nrow(foo), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1])))
foo$sum <- c(0, sapply(2:nrow(foo), ave(foo$A_Photosynthesis, foo$unique_leaf, FUN=function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1])))
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$sum <- NA
for(i in 1:length(inds)){
foo$sum[i] <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo <- foo[(foo$sum>5),]
foo$sum[i] <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo <- foo[(foo$sum>5),]
}
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$sum <- NA
for(i in 1:length(inds)){
foo$sum[i] <- c(0, sapply(2:nrow(foo)[i], function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo <- foo[(foo$sum>5),]
foo$sum[i] <- c(0, sapply(2:nrow(foo)[i], function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo <- foo[(foo$sum>5),]
}
sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1])
i=1
sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1])
foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]
function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]
sapply(2:nrow(foo), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1])
c(0, sapply(2:nrow(foo), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo <- juju2
sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1])
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
foo$sum[i] <- sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1])
foo <- foo[(foo$sum>5),]
}
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
foo$sum <- sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1])
foo <- foo[(foo$sum>5),]
}
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
foo$sum <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo <- foo[(foo$sum>5),]
}
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
foo$sum[i] <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo <- foo[(foo$sum>5),]
}
i=1
foo$sum[i] <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1])
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$sum <- NA
c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1])
)
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$sum <- NA
i=1
summy <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum <- summy
foo$sum
foo <- foo[(foo$sum>5),]
foo
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum <- summy
foo <- foo[(foo$sum<5),]
}
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$sum <- NA
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$sum <- NA
i=1
summy <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[i] <- summy
summy[i] <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$sum <- NA
summy[i] <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$sum <- NA
summy <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[i] <- summy
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo <- c(foo, summy)
}
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$sum <- NA
summy <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
summy
foo <- c(foo, summy)
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$sum <- NA
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo <- cbind(foo, summy)
}
foo <- foo[(foo$sum<5),]
View(foo)
foo <- juju2
inds <- unique(foo$unique_leaf)
summy <- c()
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[i] <- summy[1]
}
foo <- juju2
inds <- unique(foo$unique_leaf)
summy <- c()
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[i] <- summy[1]
}
foo <- juju2
inds <- unique(foo$unique_leaf)
summy <- c()
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum <- c(foo$sum, summy)
}
foo <- juju2
inds <- unique(foo$unique_leaf)
summy <- c()
foo$sum <- NA
i=1
summy <- c(0, sapply(2:nrow(foo[i]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
summy
foo <- juju2
inds <- unique(foo$unique_leaf)
summy <- c()
foo$sum <- NA
i=1
summy <- c(0, sapply(2:nrow(foo)[i], function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
summy
2:nrow(foo[i])
foo$spind <- as.numeric(as.factor(foo$unique_leaf))
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$spind <- as.numeric(as.factor(foo$unique_leaf))
summy <- c()
foo$sum <- NA
i=1
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
summy
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$spind <- as.numeric(as.factor(foo$unique_leaf))
summy <- c()
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[(foo$spind==i),] <- summy[1]
}
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$spind <- as.numeric(as.factor(foo$unique_leaf))
summy <- c()
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[(foo$spind==i)] <- summy[1]
}
View(foo)
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$spind <- as.numeric(as.factor(foo$unique_leaf))
summy <- c()
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[(foo$spind==i)] <- summy[i]
}
View(foo)
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$spind <- as.numeric(as.factor(foo$unique_leaf))
summy <- c()
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum <- c(foo$sum, summy)
}
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$spind <- as.numeric(as.factor(foo$unique_leaf))
summy <- c()
foo$sum <- NA
i=1
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
summy
c(foo$sum, summy)
c(foo$sum[(foo$spind==i)], summy)
foo$sum[(foo$spind==i)] <- summy
foo
View(foo)
summy[1]
summy
foo$sum[(foo$spind==i)] <- summy
foo$sum
foo$spind==i
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$spind <- as.numeric(as.factor(foo$unique_leaf))
summy <- c()
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[(foo$spind==i)] <- summy
}
View(foo)
foo <- foo[(foo$sum>5),]
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$spind <- as.numeric(as.factor(foo$unique_leaf))
summy <- c()
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[(foo$spind==i)] <- summy
}
foo <- foo[(foo$sum<5),]
View(foo)
View(juju2)
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$spind <- as.numeric(as.factor(foo$unique_leaf))
summy <- c()
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[(foo$spind==i)] <- summy
if(foo$sum>5){
summy <- c()
foo$sum <- NA
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[(foo$spind==i)] <- summy
if(foo$sum>5){
summy <- c()
foo$sum <- NA
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[(foo$spind==i)] <- summy
if(foo$sum>5){
summy <- c()
foo$sum <- NA
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[(foo$spind==i)] <- summy
foo <- foo[(foo$sum<5),]
}
foo <- foo[(foo$sum<5),]
}
foo <- foo[(foo$sum<5),]
}
foo <- foo[(foo$sum<5),]
}
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$spind <- as.numeric(as.factor(foo$unique_leaf))
summy <- c()
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[(foo$spind==i)] <- summy
}
foo <- foo[(foo$sum<5),]
### Do it again to make sure nothing else is sneaking through...
summy <- c()
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[(foo$spind==i)] <- summy
}
foo <- foo[(foo$sum<5),]
## And again...
summy <- c()
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[(foo$spind==i)] <- summy
}
foo <- foo[(foo$sum<5),]
## And once last time for good measure!
summy <- c()
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[(foo$spind==i)] <- summy
}
foo <- foo[(foo$sum<5),]
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$spind <- as.numeric(as.factor(foo$unique_leaf))
summy <- c()
foo$sum <- NA
for(i in 1:length(inds)){ #i=1
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
foo$sum[(foo$spind==i)] <- summy
}
i=37
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
summy
7.720875-7.729831
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo[(foo$spind==i)]$A_Photosynthesis[k]-foo[(foo$spind==i)]$A_Photosynthesis[k-1]))
foo$A_Photosynthesis[2]-foo$A_Photosynthesis[2-1]
i=1
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
summy
i=37
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[k]-foo$A_Photosynthesis[k-1]))
summy
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[(foo$spind==i)][k]-foo$A_Photosynthesis[(foo$spind==i)][k-1]))
summy
foo <- juju2
inds <- unique(foo$unique_leaf)
foo$spind <- as.numeric(as.factor(foo$unique_leaf))
summy <- c()
foo$sum <- NA
for(i in 1:length(inds)){ #i=37
summy <- c(0, sapply(2:nrow(foo[(foo$spind==i),]), function(k) foo$A_Photosynthesis[(foo$spind==i)][k]-foo$A_Photosynthesis[(foo$spind==i)][k-1]))
foo$sum[(foo$spind==i)] <- summy
}
foo <- foo[(foo$sum<5),]
# housekeeping
rm(list=ls())
options(stringsAsFactors = FALSE)
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(RColorBrewer)
juju <- read.csv("~/Downloads/superd1.csv")
subset2 <- read.csv("~/Downloads/superd2.csv")
subset2$Species <- ifelse(subset2$Species=="Asimina-triloba", "Asimina_triloba", subset2$Species)
juju$Species <- ifelse(juju$Species=="Asimina-triloba", "Asimina_triloba", juju$Species)
subset2$Species <- ifelse(subset2$Species=="Nymphaea _thermarum", "Nymphaea_thermarum", subset2$Species)
juju$Species <- ifelse(juju$Species=="Nymphaea _thermarum", "Nymphaea_thermarum", juju$Species)
allspp <- full_join(juju, subset2)
### Subset data down to relevant columns
# Date, Species, PlantID, LeafID (unique leaf)
# Time_after_excision: get
# 1) Avg of time point (0 to -80) for each leaf for A_photosynthesis for each unique leaf
juju.sub <- subset(allspp, select=c("Date", "Species", "PlantID", "LeafID", "Time_after_excision", "A_Photosynthesis"))
juju.sub$unique_leaf <- paste(juju.sub$Date, juju.sub$Species, juju.sub$PlantID, juju.sub$LeafID, sep="_")
str(juju.sub)
juju.sub$Time_after_excision <- as.numeric(juju.sub$Time_after_excision)
juju1 <- juju.sub[(juju.sub$Time_after_excision>=-80 & juju.sub$Time_after_excision<=0),]
juju1$avg_photo <- ave(juju1$A_Photosynthesis, juju1$unique_leaf)
#juju1$Time_after_excision <- NULL
#juju1$unique_leaf <- NULL
#juju1$A_Photosynthesis <- NULL
#juju.small <- juju1[!duplicated(juju1),]
#write.csv(juju.small, file="~/Downloads/avgphoto_perspecies.csv", row.names=FALSE)
# 2) Highest number of A_photosynthesis after 0 for each unique leaf and the time point for that highest photosynth
juju2 <- juju.sub[(juju.sub$Time_after_excision>0),]
juju2$high_photo <- ave(juju2$A_Photosynthesis, juju2$unique_leaf, FUN=max) ### FUN=last
#cleanuperrors <- juju2
inds <- unique(juju2$unique_leaf)
juju2$spind <- as.numeric(as.factor(juju2$unique_leaf))
summy <- c()
juju2$sum <- NA
for(i in 1:length(inds)){ #i=37
summy <- c(0, sapply(2:nrow(juju2[(juju2$spind==i),]), function(k) juju2$A_Photosynthesis[(juju2$spind==i)][k]-juju2$A_Photosynthesis[(juju2$spind==i)][k-1]))
juju2$sum[(juju2$spind==i)] <- summy
}
juju2 <- juju2[(juju2$sum<5),]
juju2.small <- subset(juju2, select=c("Date", "Species", "PlantID", "LeafID", "high_photo"))
juju2.small <- juju2.small[!duplicated(juju2.small),]
### Combine both
juju.all <- full_join(juju1, juju2.small)
juju.all$norm_peak <- juju.all$high_photo/juju.all$avg_photo
sort(unique(juju.all$Species))
juju.all <- juju.all[(juju.all$norm_peak>=0),]
juju.all <- juju.all[(juju.all$avg_photo>=0),]
juju.all.noNA <- juju.all[!is.na(juju.all$Species),]
juju.all.noNA$centered_peak <- juju.all.noNA$high_photo - juju.all.noNA$avg_photo
#write.csv(juju.all.noNA, file="...", row.names=FALSE)
############################# Plot Time ##########################
my.cols <- brewer.pal(n = 11, name = "Spectral")
my.cols <- my.cols[my.cols!=c("#FFFFBF", "#FEE08B", "#E6F598")]
quartz()
cenpeak <- ggplot(juju.all.noNA, aes(y=centered_peak, x=avg_photo, col=Species)) + geom_point() +
theme_classic() + scale_color_manual(name="Species", values=my.cols,
labels=sort(unique(juju.all$Species))) +
xlab("Avg Photosynthesis") + ylab("Normalized Peak") + geom_smooth(aes(group=Species), method="lm", se=FALSE)
cenpeak
### Helpful script for Anju notes
## Help from Cat on 27 April 2020
# housekeeping
rm(list=ls())
options(stringsAsFactors = FALSE)
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(RColorBrewer)
juju <- read.csv("~/Downloads/superd1.csv")
subset2 <- read.csv("~/Downloads/superd2.csv")
subset2$Species <- ifelse(subset2$Species=="Asimina-triloba", "Asimina_triloba", subset2$Species)
juju$Species <- ifelse(juju$Species=="Asimina-triloba", "Asimina_triloba", juju$Species)
subset2$Species <- ifelse(subset2$Species=="Nymphaea _thermarum", "Nymphaea_thermarum", subset2$Species)
juju$Species <- ifelse(juju$Species=="Nymphaea _thermarum", "Nymphaea_thermarum", juju$Species)
allspp <- full_join(juju, subset2)
### Subset data down to relevant columns
# Date, Species, PlantID, LeafID (unique leaf)
# Time_after_excision: get
# 1) Avg of time point (0 to -80) for each leaf for A_photosynthesis for each unique leaf
juju.sub <- subset(allspp, select=c("Date", "Species", "PlantID", "LeafID", "Time_after_excision", "A_Photosynthesis"))
juju.sub$unique_leaf <- paste(juju.sub$Date, juju.sub$Species, juju.sub$PlantID, juju.sub$LeafID, sep="_")
str(juju.sub)
juju.sub$Time_after_excision <- as.numeric(juju.sub$Time_after_excision)
juju1 <- juju.sub[(juju.sub$Time_after_excision>=-80 & juju.sub$Time_after_excision<=0),]
juju1$avg_photo <- ave(juju1$A_Photosynthesis, juju1$unique_leaf)
#juju1$Time_after_excision <- NULL
#juju1$unique_leaf <- NULL
#juju1$A_Photosynthesis <- NULL
#juju.small <- juju1[!duplicated(juju1),]
#write.csv(juju.small, file="~/Downloads/avgphoto_perspecies.csv", row.names=FALSE)
# 2) Highest number of A_photosynthesis after 0 for each unique leaf and the time point for that highest photosynth
juju2 <- juju.sub[(juju.sub$Time_after_excision>0),]
#cleanuperrors <- juju2
inds <- unique(juju2$unique_leaf)
juju2$spind <- as.numeric(as.factor(juju2$unique_leaf))
summy <- c()
juju2$sum <- NA
for(i in 1:length(inds)){ #i=37
summy <- c(0, sapply(2:nrow(juju2[(juju2$spind==i),]), function(k) juju2$A_Photosynthesis[(juju2$spind==i)][k]-juju2$A_Photosynthesis[(juju2$spind==i)][k-1]))
juju2$sum[(juju2$spind==i)] <- summy
}
juju2 <- juju2[(juju2$sum<5),]
juju2$high_photo <- ave(juju2$A_Photosynthesis, juju2$unique_leaf, FUN=max) ### FUN=last
juju2.small <- subset(juju2, select=c("Date", "Species", "PlantID", "LeafID", "high_photo"))
juju2.small <- juju2.small[!duplicated(juju2.small),]
### Combine both
juju.all <- full_join(juju1, juju2.small)
juju.all$norm_peak <- juju.all$high_photo/juju.all$avg_photo
sort(unique(juju.all$Species))
juju.all <- juju.all[(juju.all$norm_peak>=0),]
juju.all <- juju.all[(juju.all$avg_photo>=0),]
juju.all.noNA <- juju.all[!is.na(juju.all$Species),]
juju.all.noNA$centered_peak <- juju.all.noNA$high_photo - juju.all.noNA$avg_photo
#write.csv(juju.all.noNA, file="...", row.names=FALSE)
############################# Plot Time ##########################
my.cols <- brewer.pal(n = 11, name = "Spectral")
my.cols <- my.cols[my.cols!=c("#FFFFBF", "#FEE08B", "#E6F598")]
quartz()
cenpeak <- ggplot(juju.all.noNA, aes(y=centered_peak, x=avg_photo, col=Species)) + geom_point() +
theme_classic() + scale_color_manual(name="Species", values=my.cols,
labels=sort(unique(juju.all$Species))) +
xlab("Avg Photosynthesis") + ylab("Centered Peak") + geom_smooth(aes(group=Species), method="lm", se=FALSE)
cenpeak
my.cols
#write.csv(juju.all.noNA, file="...", row.names=FALSE)
############################# Plot Time ##########################
my.cols <- brewer.pal(n = 11, name = "Spectral")
#write.csv(juju.all.noNA, file="...", row.names=FALSE)
############################# Plot Time ##########################
my.cols <- brewer.pal(n = 11, name = "Spectral")
my.cols <- my.cols[!(my.cols=c("#FFFFBF", "#FEE08B", "#E6F598"))]
#write.csv(juju.all.noNA, file="...", row.names=FALSE)
############################# Plot Time ##########################
my.cols <- brewer.pal(n = 11, name = "Spectral")
my.cols <- my.cols[(my.cols!=c("#FFFFBF", "#FEE08B", "#E6F598"))]
my.cols
#write.csv(juju.all.noNA, file="...", row.names=FALSE)
############################# Plot Time ##########################
my.cols <- brewer.pal(n = 11, name = "Spectral")
my.cols <- my.cols[(my.cols!=c("#FFFFBF", "#FEE08B", "#E6F598")),]
#write.csv(juju.all.noNA, file="...", row.names=FALSE)
############################# Plot Time ##########################
my.cols <- brewer.pal(n = 11, name = "Spectral")
my.cols <- my.cols[(my.cols!=c("#FFFFBF"))]
my.cols
quartz()
cenpeak <- ggplot(juju.all.noNA, aes(y=centered_peak, x=avg_photo, col=Species)) + geom_point() +
theme_classic() + scale_color_manual(name="Species", values=my.cols,
labels=sort(unique(juju.all$Species))) +
xlab("Avg Photosynthesis") + ylab("Centered Peak") + geom_smooth(aes(group=Species), method="lm", se=FALSE)
cenpeak
