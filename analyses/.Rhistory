a <- -1
z <- a + ba*agri + bc*cc
p <- 1/(1+exp(-z))
y <- rbinom(ndata, 1, p)
m0 <- lm(y ~ agri + cc + agri + agri:cc)
0.433774 + -0.038109*mean(agri)
m1 <- glm(y ~ agri + cc +agri:cc, family = "binomial")
int = -0.829
testnonz <- function(coef, pred) {(invlogit(int + coef*mean(pred)) -
invlogit(int + coef*(mean(pred)-1)))*100}
testnonz(-0.45496, agri) ## -10.12255
agri.z <- (agri-mean(agri,na.rm=TRUE))/(2*sd(agri,na.rm=TRUE))
#### Using Gelman-Hill method
invlogit <- function(x) {(1/(1+exp(-(x))))}
ndata <- 1000
agri <- rnorm(ndata, 0, 10)
cc <- rnorm(ndata, 0, 1)
ba <- -0.5
bc <- 0.5
a <- -1
z <- a + ba*agri + bc*cc
p <- 1/(1+exp(-z))
y <- rbinom(ndata, 1, p)
m0 <- lm(y ~ agri + cc + agri + agri:cc)
0.433774 + -0.038109*mean(agri)
m1 <- glm(y ~ agri + cc +agri:cc, family = "binomial")
int = -0.829
testnonz <- function(coef, pred) {(invlogit(int + coef*mean(pred)) -
invlogit(int + coef*(mean(pred)-1)))*100}
testnonz(-0.45496, agri) ## -10.12255
agri.z <- (agri-mean(agri,na.rm=TRUE))/(2*sd(agri,na.rm=TRUE))
cc.z <- (cc-mean(cc,na.rm=TRUE))/(2*sd(cc,na.rm=TRUE))
m2 <- glm(y ~ agri.z + cc.z + agri.z:cc.z, family = "binomial")
int = -0.8653
testz <- function(coef, pred) {(invlogit(int + (coef/(sd(pred)*2))*mean(pred)) -
invlogit(int + (coef/(sd(pred)*2))*(mean(pred)-1)))*100}
testz <- function(coef, pred) {(invlogit( + (coef*(sd(pred)*2)+mean(pred))*mean(pred)) -
invlogit(int + (coef*(sd(pred)*2)+mean(pred))*(mean(pred)-1)))*100}
testz(-8.715, agri) ## -10.13641
testz <- function(coef, pred) {(invlogit( + (coef*(sd(pred)*2))*mean(pred)) -
invlogit(int + (coef*(sd(pred)*2))*(mean(pred)-1)))*100}
testz(-8.715, agri) ## -100
testz <- function(coef, pred) {(invlogit( + (coef/(sd(pred)*2))*mean(pred)) -
invlogit(int + (coef/(sd(pred)*2))*(mean(pred)-1)))*100}
testz(-8.715, agri) ## -100
testz <- function(coef, pred) {(invlogit(int + (coef*(sd(pred)*2))*mean(pred)) -
invlogit(int + (coef*(sd(pred)*2))*(mean(pred)-1)))*100}
testz(-8.715, agri) ## -100
mean(pred)
pred=agri
mean(pred)
range(pred)
coef*(sd(pred)*2)
(coef*(sd(pred)*2))
coef=-8.715
(coef*(sd(pred)*2))
(invlogit(int + (coef*(sd(pred)*2))*mean(pred))
)
div4 = coef/4
div4
testz <- function(coef, pred) {(invlogit(int + coef*mean(pred))) -
invlogit(int + (coef*(mean(pred)-1)))*100}
testz(-8.715, agri) ## -100
pred=agri.z
testz <- function(coef, pred) {(int + coef*mean(pred)) - (int + (coef*(mean(pred)-1)))}
zpred <- testz(-8.715, agri) ##
zpred
pred=agri
div4 = coef/4 #-2.17875
testz <- function(coef, pred) {(int + coef*mean(pred)) - (int + (coef*(mean(pred)-1)))}
zpred <- testz(-8.715, agri) ##
zpred
(int + coef*mean(pred)) - (int + (coef*(mean(pred)-1))
)
testz <- function(coef, pred) {(int + coef*mean(pred)) - (int + (coef*(mean(pred)-1)))}
testz(-8.715, agri) ## -100
int + coef*mean(pred)
int + (coef*(mean(pred)-1)
)
ndata <- 1000
agri <- rnorm(ndata, 0, 10)
cc <- rnorm(ndata, 0, 1)
ba <- -0.5
bc <- 0.5
a <- -1
z <- a + ba*agri + bc*cc
p <- 1/(1+exp(-z))
y <- rbinom(ndata, 1, p)
m0 <- lm(y ~ agri + cc + agri + agri:cc)
0.433774 + -0.038109*mean(agri)
m1 <- glm(y ~ agri + cc +agri:cc, family = "binomial")
int = -0.829
testnonz <- function(coef, pred) {(invlogit(int + coef*mean(pred)) -
invlogit(int + coef*(mean(pred)-1)))*100}
testnonz(-0.45496, agri) ## -10.22591
-0.45496/4
m0
-0.038109/4
#### Now try and make fake data to really tease this apart and test
set.seed(1234)
ndata <- 1000
agri <- rnorm(ndata, 0, 10)
cc <- rnorm(ndata, 0, 1)
ba <- -0.5
bc <- 0.5
a <- -1
z <- a + ba*agri + bc*cc
p <- 1/(1+exp(-z))
y <- rbinom(ndata, 1, p)
m0 <- lm(y ~ agri + cc + agri + agri:cc)
m0
m1 <- glm(y ~ agri + cc +agri:cc, family = "binomial")
m1
coef(m1)
coef(m1)[1]
(coef(m1)[2])/4
int = coef(m1)[1]
testnonz <- function(coef, pred) {(invlogit(int + coef*mean(pred)) -
invlogit(int + coef*(mean(pred)-1)))*100}
testnonz((coef(m1)[2]), agri) ## -9.922911
summary(m1)
rm(list=ls())
options(stringsAsFactors = FALSE)
# Load libraries
library(RColorBrewer)
library(ggplot2)
library(dplyr)
library(tidyr)
library(brms)
# Set working directory
setwd("~/Documents/git/microclimates/analyses")
#### Now time for CG provenance.lat and year
###
gdd.stan <- read.csv("output/clean_gdd_bbanddvr.csv", header=TRUE)
gdd.stan <- gdd.stan[(gdd.stan$type=="Common Garden"),]
gdd.stan <- gdd.stan[(gdd.stan$gdd_bb<1000),]
gdd.stan$spp <- paste(substr(gdd.stan$genus, 0, 3), substr(gdd.stan$species, 0, 3), sep="")
cg <- subset(gdd.stan, select=c("gdd_bb", "provenance.lat", "spp", "year"))
cg <- na.omit(cg)
mod_cg <- brm(gdd_bb ~ provenance.lat + (provenance.lat | spp), data=cg,
control=list(max_treedepth = 15,adapt_delta = 0.99),
iter=4000, warmup=2500)
save(mod_cg, file="stan/mod_cg_prov.Rdata")
mod_cg
modoutput <- cg.mod #modelhere
cg.mod<-as.data.frame(tidy(mod_cg, prob=0.5))
modoutput <- cg.mod #modelhere
######
library(broom)
cg.mod<-as.data.frame(tidy(mod_cg, prob=0.5))
modoutput <- cg.mod #modelhere
modoutput<-modoutput[c(2, 22:36),]
modoutput$lower <- modoutput$lower
modoutput$upper <- modoutput$upper
modoutput$term<-gsub(".*b_","",modoutput$term)
modoutput$term<-gsub(".*spp","",modoutput$term)
modoutput$term <- ifelse(grepl(",provenance.lat", modoutput$term), substr(modoutput$term, 2, 7), modoutput$term)
#### Now for mu plots based of bb_analysis/models_stan_plotting.R ###
figpath <- "figures"
figpathmore <- "cg_prov" ### change based on model
source("exp_muplot_brms.R")
cols <- adjustcolor("indianred3", alpha.f = 0.3)
my.pal <- rep(brewer.pal(n = 8, name = "Dark2"), 8)
my.pch <- rep(15:16, each=8)
unique(cg$spp)
source("exp_muplot_brms.R")
cols <- adjustcolor("indianred3", alpha.f = 0.3)
my.pal <- rep(brewer.pal(n = 8, name = "Dark2"), 8)
my.pch <- rep(15:16, each=8)
#my.pch <- my.pch[c(1:12, 14:29, 31:32, 34:48)]
# display.brewer.all()
alphahere = 0.4
xlab <- "Model estimate of change in \ngrowing degree days to budburst" ## change based on model
spp <- unique(gdd$spp)
spp <- unique(cg$spp)
modelhere <- mod_hobo
modelhere <- mod_cg
prov.lat <- coef(modelhere, prob=c(0.25, 0.75))$spp[, c(1, 3:4), 2] %>%
as.data.frame() %>%
round(digits = 2) %>%
rename(mean = Estimate) %>%
rename(lower = Q25) %>%
rename(upper = Q75) %>%
dplyr::select( mean, lower, upper)
new.names<-NULL
for(i in 1:length(spp)){
new.names[i]<-paste("prov.lat", "[", i, "]", sep="")
}
prov.lat$parameter<-new.names
mod.ranef<-prov.lat
#modoutput <- tidy(modelhere, prob=c(0.5))
#quartz()
#muplotfx(modelhere, "", 8, 8, c(0,5), c(-10, 10) , 10.5, 3.5)
muplotfx(modelhere, "", 8, 8, c(0,0), c(-5, 10) , 10.5, 1)
gdd.stan <- read.csv("output/clean_gdd_bbanddvr.csv", header=TRUE)
gdd.stan <- gdd.stan[(gdd.stan$type=="Common Garden"),]
gdd.stan <- gdd.stan[(gdd.stan$gdd_bb<1000),]
gdd.stan$spp <- paste(substr(gdd.stan$genus, 0, 3), substr(gdd.stan$species, 0, 3), sep="")
gdd.stan$spp <- ifelse(gdd.stan$spp=="NANA", "Quealb", gdd.stan$spp)
cg <- subset(gdd.stan, select=c("gdd_bb", "provenance.lat", "spp", "year"))
cg <- na.omit(cg)
gdd<-cg
#modoutput <- tidy(modelhere, prob=c(0.5))
#quartz()
#muplotfx(modelhere, "", 8, 8, c(0,5), c(-10, 10) , 10.5, 3.5)
muplotfx(modelhere, "", 8, 8, c(0,0), c(-5, 10) , 10.5, 1)
rm(list=ls())
options(stringsAsFactors = FALSE)
# Load libraries
library(RColorBrewer)
library(ggplot2)
library(dplyr)
library(tidyr)
library(brms)
# Set working directory
setwd("~/Documents/git/microclimates/analyses")
## Load the data
gdd.stan <- read.csv("output/clean_gdd_bbanddvr.csv", header=TRUE)
gdd.hobo <- read.csv("output/clean_gdd_bbanddvr_hobo.csv", header=TRUE)
if(FALSE){ ## Testing code
gdd.stan$stationbb <- gdd.stan$gdd_bb
gdd.stan$gdd_bb <- NULL
gdd.stan$stationdvr <- gdd.stan$gdd_dvr
gdd.stan$gdd_dvr <- NULL
gdd <- left_join(gdd.hobo, gdd.stan)
gdd$diffbb <- gdd$stationbb - gdd$gdd_bb
gdd$diffdvr <- gdd$stationdvr - gdd$gdd_dvr
range(gdd$diffdvr, na.rm=TRUE)
range(gdd$diffbb, na.rm=TRUE)
}
gdd.stan <- gdd.stan[(gdd.stan$type=="Treespotters"),]
gdd.hobo <- gdd.hobo[(gdd.hobo$type=="Treespotters"),]
gdd.hobo$gdd_bb_hobo <- gdd.hobo$gdd_bb
gdd.hobo$gdd_dvr_hobo <- gdd.hobo$gdd_dvr
gdd.hobo$gdd_bb <- NULL
gdd.hobo$gdd_dvr <- NULL
gdd.hobo$spp <- paste(substr(gdd.hobo$genus, 0, 3), substr(gdd.hobo$species, 0, 3), sep="")
gdd.stan$spp <- paste(substr(gdd.stan$genus, 0, 3), substr(gdd.stan$species, 0, 3), sep="")
commoncols <- c("id", "provenance.lat", "fs.count", "year", "budburst", "leafout", "spp", "climatetype")
gdd.hobo <- subset(gdd.hobo, select=c(commoncols, "gdd_bb_hobo", "gdd_dvr_hobo"))
gdd.stan <- subset(gdd.stan, select=c(commoncols, "gdd_bb", "gdd_dvr"))
gdd.hobo$hobonum <- gdd.hobo$climatetype
gdd.hobo$climatetype <- NULL
gdd <- full_join(gdd.stan, gdd.hobo)
gdd$dvr <- gdd$leafout - gdd$budburst
gdd$leafout <- NULL
gdd <- gdd[(gdd$year==2019),]
gdd <- gdd[(gdd$gdd_bb<=1000),]
gdd <- gdd[(gdd$gdd_bb_hobo<=1000),]
station <- subset(gdd.stan, select=c("gdd_bb", "provenance.lat", "spp"))
station <- na.omit(station)
hobo <- subset(gdd, select=c("gdd_bb_hobo", "provenance.lat", "spp"))
hobo <- na.omit(hobo)
mod_station <- brm(gdd_bb ~ spp, data=station,
control=list(max_treedepth = 15,adapt_delta = 0.99),
iter=10000, warmup=2500)
save(mod_station, file="stan/mod_station.Rdata")
mod_hobo <- brm(gdd_bb_hobo ~ spp, data=hobo,
control=list(max_treedepth = 15,adapt_delta = 0.99),
iter=10000, warmup=2500)
save(mod_hobo, file="stan/mod_hobo.Rdata")
mod_station
mod_hobo
hobo.mod<-as.data.frame(tidy(mod_hobo, prob=0.5))
modoutput <- hobo.mod #modelhere
#modoutput<-modoutput[1:4,]
modoutput$`25%` <- modoutput$lower
modoutput$`75%` <- modoutput$upper
modoutput$term<-gsub(".*b_","",modoutput$term)
modoutput$term<-gsub(".*spp","",modoutput$term)
#modoutput$term <- ifelse(modoutput$term=="provenance.lat", "xlat", modoutput$term)
modoutput$Jvar <- as.numeric(rev(as.factor(modoutput$term)))
#estimates<-c("Acer saccharum", "Aesculus flava", "Betula alleghaniense", "Betula nigra", "Carya glabra", "Carya ovata",
#            "Fagus grandifolia", "Hamamelis virginiana", "Populus deltoides", "Quercus alba", "Quercus rubra", "Tilia americana",
#           "Vaccinium corymbosum", "Viburnum nudum", "Provenance Latitude")
estimates<-c("Intercept", unique(gdd$spp[(gdd$spp!="Acepen")]))
estimates<-rev(estimates)
modoutput <- modoutput[!is.na(modoutput$Jvar),]
muplot<-ggplot(modoutput, aes(x=`25%`, xend=`75%`, y=Jvar, yend=Jvar)) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar), col="black") +
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = sort(unique(modoutput$term)), labels=unique(gdd$spp)) +
xlab("Change in growing degree days \nfrom budburst to leafout") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0,
plot.margin = unit(c(1,1,1,1), "lines")) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-150, 150), ylim=c(1,3), clip = 'off') #+ ggtitle("Hobo Loggers")
quartz()
muplot
#estimates<-c("Acer saccharum", "Aesculus flava", "Betula alleghaniense", "Betula nigra", "Carya glabra", "Carya ovata",
#            "Fagus grandifolia", "Hamamelis virginiana", "Populus deltoides", "Quercus alba", "Quercus rubra", "Tilia americana",
#           "Vaccinium corymbosum", "Viburnum nudum", "Provenance Latitude")
estimates<-c("Intercept", unique(gdd.hobo$spp[(gdd.hobo$spp!="Acepen")]))
estimates<-rev(estimates)
muplot<-ggplot(modoutput, aes(x=`25%`, xend=`75%`, y=Jvar, yend=Jvar)) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar), col="black") +
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = sort(unique(modoutput$term)), labels=unique(gdd$spp)) +
xlab("Change in growing degree days \nfrom budburst to leafout") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0,
plot.margin = unit(c(1,1,1,1), "lines")) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-150, 150), ylim=c(1,3), clip = 'off') #+ ggtitle("Hobo Loggers")
muplot
muplot<-ggplot(modoutput, aes(x=`25%`, xend=`75%`, y=Jvar, yend=Jvar)) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar), col="black") +
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = sort(unique(modoutput$term)), labels=unique(gdd$spp)) +
xlab("Change in growing degree days \nfrom budburst to leafout") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0,
plot.margin = unit(c(1,1,1,1), "lines")) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-300, 700), ylim=c(1,18), clip = 'off') #+ ggtitle("Hobo Loggers")
muplot
#estimates<-c("Acer saccharum", "Aesculus flava", "Betula alleghaniense", "Betula nigra", "Carya glabra", "Carya ovata",
#            "Fagus grandifolia", "Hamamelis virginiana", "Populus deltoides", "Quercus alba", "Quercus rubra", "Tilia americana",
#           "Vaccinium corymbosum", "Viburnum nudum", "Provenance Latitude")
estimates<-c("Intercept", sort(unique(gdd.hobo$spp[(gdd.hobo$spp!="Acepen")])))
estimates<-rev(estimates)
muplot<-ggplot(modoutput, aes(x=`25%`, xend=`75%`, y=Jvar, yend=Jvar)) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar), col="black") +
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = sort(unique(modoutput$term)), labels=unique(gdd$spp)) +
xlab("Change in growing degree days \nfrom budburst to leafout") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0,
plot.margin = unit(c(1,1,1,1), "lines")) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-300, 700), ylim=c(1,16), clip = 'off') #+ ggtitle("Hobo Loggers")
muplot
muplot<-ggplot(modoutput, aes(x=`25%`, xend=`75%`, y=Jvar, yend=Jvar)) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar), col="black") +
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = sort(unique(modoutput$term)), labels=unique(gdd$spp)) +
xlab("Change in growing degree days \nfrom budburst to leafout") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0,
plot.margin = unit(c(1,1,1,1), "lines")) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-300, 700), ylim=c(1,17), clip = 'off') #+ ggtitle("Hobo Loggers")
muplot
View(muplot)
View(modoutput)
modoutput <- hobo.mod #modelhere
modoutput<-modoutput[1:15,]
modoutput$`25%` <- modoutput$lower
modoutput$`75%` <- modoutput$upper
modoutput$term<-gsub(".*b_","",modoutput$term)
modoutput$term<-gsub(".*spp","",modoutput$term)
#modoutput$term <- ifelse(modoutput$term=="provenance.lat", "xlat", modoutput$term)
modoutput$Jvar <- as.numeric(rev(as.factor(modoutput$term)))
#estimates<-c("Acer saccharum", "Aesculus flava", "Betula alleghaniense", "Betula nigra", "Carya glabra", "Carya ovata",
#            "Fagus grandifolia", "Hamamelis virginiana", "Populus deltoides", "Quercus alba", "Quercus rubra", "Tilia americana",
#           "Vaccinium corymbosum", "Viburnum nudum", "Provenance Latitude")
estimates<-c("Intercept", sort(unique(gdd.hobo$spp[(gdd.hobo$spp!="Acepen")])))
estimates<-rev(estimates)
modoutput <- modoutput[!is.na(modoutput$Jvar),]
muplot<-ggplot(modoutput, aes(x=`25%`, xend=`75%`, y=Jvar, yend=Jvar)) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar), col="black") +
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = sort(unique(modoutput$term)), labels=unique(gdd$spp)) +
xlab("Change in growing degree days \nfrom budburst to leafout") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0,
plot.margin = unit(c(1,1,1,1), "lines")) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-300, 700), ylim=c(1,17), clip = 'off') #+ ggtitle("Hobo Loggers")
muplot
muplot<-ggplot(modoutput, aes(x=`25%`, xend=`75%`, y=Jvar, yend=Jvar)) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar), col="black") +
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = sort(unique(modoutput$term))) +
xlab("Change in growing degree days \nfrom budburst to leafout") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0,
plot.margin = unit(c(1,1,1,1), "lines")) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-300, 700), ylim=c(1,17), clip = 'off') #+ ggtitle("Hobo Loggers")
muplot
View(modoutput)
modoutput<-modoutput[1:15,]
modoutput$`25%` <- modoutput$lower
modoutput$`75%` <- modoutput$upper
modoutput$term<-gsub(".*b_","",modoutput$term)
modoutput$term<-gsub(".*spp","",modoutput$term)
#modoutput$term <- ifelse(modoutput$term=="provenance.lat", "xlat", modoutput$term)
modoutput$Jvar <- rev(as.numeric(as.factor(modoutput$term)))
View(modoutput)
muplot<-ggplot(modoutput, aes(x=`25%`, xend=`75%`, y=Jvar, yend=Jvar)) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar), col="black") +
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = sort(unique(modoutput$Jvar))) +
xlab("Change in growing degree days \nfrom budburst to leafout") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0,
plot.margin = unit(c(1,1,1,1), "lines")) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-300, 700), ylim=c(1,17), clip = 'off') #+ ggtitle("Hobo Loggers")
muplot
muplot<-ggplot(modoutput, aes(x=`25%`, xend=`75%`, y=Jvar, yend=Jvar)) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar), col="black") +
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = sort(unique(modoutput$Jvar))) +
xlab("Change in growing degree days \nfrom budburst to leafout") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0,
plot.margin = unit(c(1,1,1,1), "lines")) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-300, 700), ylim=c(1,15), clip = 'off') #+ ggtitle("Hobo Loggers")
muplot
muplot<-ggplot(modoutput, aes(x=`25%`, xend=`75%`, y=Jvar, yend=Jvar)) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar), col="black") +
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = unique(modoutput$term)) +
xlab("Change in growing degree days \nfrom budburst to leafout") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0,
plot.margin = unit(c(1,1,1,1), "lines")) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-300, 700), ylim=c(1,15), clip = 'off') #+ ggtitle("Hobo Loggers")
muplot
muplot<-ggplot(modoutput, aes(x=`25%`, xend=`75%`, y=Jvar, yend=Jvar)) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar), col="black") +
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = rev(unique(modoutput$term))) +
xlab("Change in growing degree days \nfrom budburst to leafout") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0,
plot.margin = unit(c(1,1,1,1), "lines")) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-300, 700), ylim=c(1,15), clip = 'off') #+ ggtitle("Hobo Loggers")
muplot
muplot<-ggplot(modoutput, aes(x=`25%`, xend=`75%`, y=Jvar, yend=Jvar)) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar), col="black") +
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = rev(unique(modoutput$term))) +
xlab("Change in growing degree days \nfrom budburst to leafout") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0,
plot.margin = unit(c(1,1,1,1), "lines")) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-150, 500), ylim=c(1,15), clip = 'off') #+ ggtitle("Hobo Loggers")
muplot
station.mod<-as.data.frame(tidy(mod_station, prob=0.5))
modoutput <- station.mod #modelhere
modoutput<-modoutput[1:15,]
modoutput$`25%` <- modoutput$lower
modoutput$`75%` <- modoutput$upper
modoutput$term<-gsub(".*b_","",modoutput$term)
modoutput$term<-gsub(".*spp","",modoutput$term)
#modoutput$term <- ifelse(modoutput$term=="provenance.lat", "xlat", modoutput$term)
modoutput$Jvar <- rev(as.numeric(as.factor(modoutput$term)))
#estimates<-c("Acer saccharum", "Aesculus flava", "Betula alleghaniense", "Betula nigra", "Carya glabra", "Carya ovata",
#            "Fagus grandifolia", "Hamamelis virginiana", "Populus deltoides", "Quercus alba", "Quercus rubra", "Tilia americana",
#           "Vaccinium corymbosum", "Viburnum nudum", "Provenance Latitude")
estimates<-c("Intercept", sort(unique(gdd.hobo$spp[(gdd.hobo$spp!="Acepen")])))
estimates<-rev(estimates)
modoutput <- modoutput[!is.na(modoutput$Jvar),]
muplot<-ggplot(modoutput, aes(x=`25%`, xend=`75%`, y=Jvar, yend=Jvar)) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar), col="black") +
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = rev(unique(modoutput$term))) +
xlab("Change in growing degree days \nfrom budburst to leafout") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0,
plot.margin = unit(c(1,1,1,1), "lines")) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-150, 500), ylim=c(1,15), clip = 'off') #+ ggtitle("Hobo Loggers")
quartz()
muplot
