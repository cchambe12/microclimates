}
dayz <- rep(1:daysperyr, nobs)
cc.arb <- 6 ## based off weather station data
microarb.effect <- 0
sigma.arb <- 2
microsigmaarb.effect <- 0   #### by keeping the sigmas the same for the microsites (line 76 & 81) we assume that the microclimatic effects are the same across sites
dayz <- rep(1:daysperyr, nobs)
cc.arb <- 6 ## based off weather station data
microarb.effect <- 2
sigma.arb <- 2
microsigmaarb.effect <- 1   #### by keeping the sigmas the same for the microsites (line 76 & 81) we assume that the microclimatic effects are the same across sites
cc.hf <- 4  ## based off weather station data
microhf.effect <- 2
sigma.hf <- 2
microsigmahf.effect <- 1  #### by keeping the sigmas the same for the microsites (line 76 & 81) we assume that the microclimatic effects are the same across sites
#source("simulations/micro_databuildfx.R")
if(use.fstar==TRUE){
source("simulations/micro_databuildfx.R")
}
if(use.doy==TRUE){
source("simulations/micro_databuildfx_doy.R")
}
cols <-viridis_pal(option="viridis")(3)
## Just a quick check on GDDs
quartz(width=4, height=4)
if(use.fstar==TRUE){
ggplot(df.fstar, aes(x=df.fstar$gdd)) + geom_histogram(aes(fill=site)) + theme_classic() +
scale_fill_manual(name="Site", values=cols, labels=sort(unique(df.fstar$site)))
}
if(use.doy==TRUE){
ggplot(bball, aes(x=gdd)) + geom_histogram(aes(fill=site)) + theme_classic() +
scale_fill_manual(name="Site", values=cols, labels=sort(unique(df$site)))
}
View(bball)
View(df.fstar)
# Step 3: Make a data frame and get the mean temp per year (to double check the data)
df <- dplyr::full_join(arbclim, hfclim)
df$tmean <- as.numeric(df$tmean)
df$sp_ind <- paste(df$species, df$ind, sep="_")
df$gdd <- ave(df$tmean, df$sp_ind, df$site, df$method, FUN=cumsum)
df$gdd.obs <- ave(df$tmean, df$sp_ind, df$site, df$method, FUN=cumsum)
df$tx <- ifelse(df$site=="arb", 1, 0)
df$gdd <- df$gdd.obs + df$tx * urbeffect + doybbindsd
View(df)
df.bb <- df[(df$day==df$dayz),]
df.bb$species <- as.numeric(df.bb$species)
bball <- full_join(df.bb, df.prov)
#### Now we simplify the dataset..
bball <- subset(bball, select=c("site", "method", "species", "ind", "provenance", "dayz", "gdd"))
colnames(bball) <- c("site", "method", "species", "ind", "provenance", "bb", "gdd")
bball <- bball[!duplicated(bball),]
if(use.doy==TRUE){
ggplot(bball, aes(x=gdd)) + geom_histogram(aes(fill=site)) + theme_classic() +
scale_fill_manual(name="Site", values=cols, labels=sort(unique(df$site)))
}
# housekeeping
rm(list=ls())
options(stringsAsFactors = FALSE)
#### Questions to address:
# GDDlo ~ urban + (urban|species)
## Let's start with Question 1 first...
#library(rethinking)
library(RColorBrewer)
library(viridis)
library(lme4)
library(ggplot2)
library(gridExtra)
library(rstan)
## Let's load some real data to check out.
setwd("~/Documents/git/microclimates/analyses/")
if(FALSE){
ws <- read.csv("output/clean_gdd_chill_bbanddvr.csv")
mean(ws$gdd_bb, na.rm=TRUE) ## 292
sd(ws$gdd_bb, na.rm = TRUE) ## 116
mean(ws$budburst) ## 109.15
sd(ws$budburst) ## 14.22
mean(ws$budburst[ws$type=="Harvard Forest"]) ## 132.75
mean(ws$budburst[ws$type=="Treespotters"]) ## 112.45
}
use.urban = TRUE
use.provenance = FALSE
use.fstar = FALSE ### This is hypothesis B: Hobos are less accurate measures of effectively the same weather
use.doy = TRUE ### This is Hypoth A: Hobos better estimate true GDD -- capture microclimate and/or they capture treatments (urban, prov, method) better…
if(use.urban == TRUE & use.provenance == TRUE){
print("Error has occurred. Can't have both urban and provenance equal TRUE!")
}
if(use.fstar == TRUE & use.doy == TRUE){
print("Error has occurred. Can't have both fstar and doy equal TRUE!")
}
# Step 1: Set up years, days per year, temperatures, sampling frequency, required GDD (fstar)
daysperyr <- 200 #### just to make sure we don't get any NAs
nspps <- 20
ninds <- 10
nobs <- nspps*ninds
nsites <- 2
nmicros <- 10
nmethods <- 2 ## weather station and hobo logger to start (want to eventually add in gridded climate data)
if(use.urban==TRUE & use.fstar==TRUE){
urbeffect <- -75  ### mu_b_tx_sp
urbsd <- 20 ## sigma_b_tx_sp
methodeffect <- -75 ## mu_b_method_sp
methodsd <- 20 ## sigma_b_method_sp
}
if(use.urban==TRUE & use.doy==TRUE){
urbeffect <- 50  ### mu_b_tx_sp
urbsd <- 3 ## sigma_b_tx_sp
methodeffect <- 50 ## mu_b_method_sp
methodsd <- 10 ## sigma_b_method_sp
}
if(use.provenance==TRUE){
proveffect <- -5
provsd <- 0 ## sigma_b_tx_sp
methodeffect <- 100 ## mu_b_method_sp
methodsd <- 0 ## sigma_b_method_sp
}
if(use.fstar==TRUE){
fstar <- 400 ## day of budburst now (this should be mu_a_sp)
fstarspeciessd <- 50 ### sigma_a_sp
fstarindsd <- 20 ## sigma_y
}
if(use.doy==TRUE){
doybb <- 80 ## day of budburst now (this should be mu_a_sp)
doybbspeciessd <- 5### sigma_a_sp
doybbindsd <- 2 ## sigma_y
}
dayz <- rep(1:daysperyr, nobs)
cc.arb <- 6 ## based off weather station data
microarb.effect <- 2
sigma.arb <- 2
microsigmaarb.effect <- 1   #### by keeping the sigmas the same for the microsites (line 76 & 81) we assume that the microclimatic effects are the same across sites
cc.hf <- 4  ## based off weather station data
microhf.effect <- 2
sigma.hf <- 2
microsigmahf.effect <- 1  #### by keeping the sigmas the same for the microsites (line 76 & 81) we assume that the microclimatic effects are the same across sites
#source("simulations/micro_databuildfx.R")
if(use.fstar==TRUE){
source("simulations/micro_databuildfx.R")
}
if(use.doy==TRUE){
source("simulations/micro_databuildfx_doy.R")
}
# Step 3: Make a data frame and get the mean temp per year (to double check the data)
df <- dplyr::full_join(arbclim, hfclim)
df$tmean <- as.numeric(df$tmean)
df$sp_ind <- paste(df$species, df$ind, sep="_")
df$gdd.obs <- ave(df$tmean, df$sp_ind, df$site, df$method, FUN=cumsum)
df$urbtx <- ifelse(df$site=="arb", 1, 0)
df$gdd <- df$gdd.obs + df$tx * urbeffect + urbsd
if(use.doy==TRUE){
source("simulations/micro_databuildfx_doy.R")
}
cols <-viridis_pal(option="viridis")(3)
## Just a quick check on GDDs
quartz(width=4, height=4)
if(use.fstar==TRUE){
ggplot(df.fstar, aes(x=df.fstar$gdd)) + geom_histogram(aes(fill=site)) + theme_classic() +
scale_fill_manual(name="Site", values=cols, labels=sort(unique(df.fstar$site)))
}
if(use.doy==TRUE){
ggplot(bball, aes(x=gdd)) + geom_histogram(aes(fill=site)) + theme_classic() +
scale_fill_manual(name="Site", values=cols, labels=sort(unique(df$site)))
}
foo <- left_join(df, df.fstar)
View(df.doybb)
if(use.urban==TRUE){
spind <- paste(rep(c(1:nspps), each=10), rep(1:ninds, 20), sep="_")
provenance.hf <- 42.5
provenance.arb <- round(rnorm(nobs, provenance.hf, 5), digits=2)
df.prov <- as.data.frame(cbind(sp_ind = rep(rep(spind, nsites),each=nmethods),
site = rep(c("arb", "hf"), each=nobs*nmethods),
provenance = c(rep(provenance.arb, each=nmethods), rep(provenance.hf, 400)),
method = rep(c("ws", "hobo"), nsites*nobs)))
df.prov$species <- as.numeric(gsub("\\_.*" , "", df.prov$sp_ind))
df.doybb <- as.data.frame(cbind(species=rep(1:nspps, each=ninds*nsites*nmethods), inds=rep(1:ninds, nmethods),
doybb=NA,
site=rep(c("arb", "hf"), each=ninds*nmethods),
method=rep(rep(c("ws", "hobo"), each=ninds), nsites*nspps)))
df.doybb$doybb <- round(rnorm(nrow(df.doybb), doybb, doybbspeciessd), digits=0)
df.doybb$sp_ind <- paste(df.doybb$species, df.doybb$inds, sep="_")
df.doybb$dayz <- df.doybb$doybb
spind <- paste(rep(1:nspps, each=10), rep(1:ninds, 20), sep="_")
provenance.hf <- 42.5
provenance.arb <- round(rnorm(nobs, provenance.hf, 5), digits=2)
df.prov <- as.data.frame(cbind(sp_ind = rep(spind, nsites),
site = rep(c("arb", "hf"), each=nobs),
provenance = c(provenance.arb, rep(provenance.hf, 200))))
fstar <- round(rnorm(nspps, fstar, fstarspeciessd), digits=0)
df.fstar <- as.data.frame(cbind(species=rep(1:nspps, each=ninds*nsites*nmethods), inds=rep(1:ninds, nmethods),
fstar=rep(fstar, each=ninds*nsites*nmethods),
site=rep(c("arb", "hf"), each=ninds*nmethods),
method=rep(rep(c("ws", "hobo"), each=ninds), nsites*nspps)))
df.fstar$fstar <- as.numeric(df.fstar$fstar)
df.fstar$sp_ind <- paste(df.fstar$species, df.fstar$inds, sep="_")
df.fstar <- full_join(df.fstar, df.prov)
}
fstar <- 400 ## day of budburst now (this should be mu_a_sp)
fstarspeciessd <- 50 ### sigma_a_sp
fstarindsd <- 20 ## sigma_y
if(use.doy==TRUE){
doybb <- 80 ## day of budburst now (this should be mu_a_sp)
doybbspeciessd <- 5### sigma_a_sp
doybbindsd <- 2 ## sigma_y
}
dayz <- rep(1:daysperyr, nobs)
cc.arb <- 6 ## based off weather station data
microarb.effect <- 2
sigma.arb <- 2
microsigmaarb.effect <- 1   #### by keeping the sigmas the same for the microsites (line 76 & 81) we assume that the microclimatic effects are the same across sites
cc.hf <- 4  ## based off weather station data
microhf.effect <- 2
sigma.hf <- 2
microsigmahf.effect <- 1  #### by keeping the sigmas the same for the microsites (line 76 & 81) we assume that the microclimatic effects are the same across sites
#source("simulations/micro_databuildfx.R")
if(use.fstar==TRUE){
source("simulations/micro_databuildfx.R")
}
if(use.doy==TRUE){
source("simulations/micro_databuildfx_doy.R")
}
class(df$species)
df$species <- as.character(df$species)
df <- left_join(df, df.fstar)
View(df)
df$bb <- df[(df$gdd >= df$fstar)[1],]
df$bb <- df[(df$gdd >= df$fstar),][1]
df$bb <- df[(df$gdd >= df$fstar),]
df$bb <- df[(df$gdd >= df$fstar)]
bbs <- df[(df$gdd >= df$fstar),]
View(bbs)
bbs <- ave(bbs$day, bbs$sp_ind, bbs$site, bbs$method, FUN=first)
bbs
bbs <- df[(df$gdd >= df$fstar),]
bbs$bb <- ave(bbs$day, bbs$sp_ind, bbs$site, bbs$method, FUN=first)
View(bbs)
df.bb <- subset(bbs, select=c("site", "method", "species", "ind", "day", "gdd", "gdd.obs", "fstar"))
df.bb$species <- as.numeric(df.bb$species)
bball <- full_join(df.bb, df.prov)
View(bball)
View(df.bb)
df.bb <- subset(bbs, select=c("site", "method", "species", "ind", "day", "gdd", "gdd.obs", "fstar", "provenance"))
df.bb$species <- as.numeric(df.bb$species)
bball <- df.bb[!duplicated(df.bb),]
df.bb <- subset(bbs, select=c("site", "method", "species", "ind", "bb", "gdd", "gdd.obs", "fstar", "provenance"))
df.bb$species <- as.numeric(df.bb$species)
bball <- df.bb[!duplicated(df.bb),]
if(use.doy==TRUE){
source("simulations/micro_databuildfx_doy.R")
}
cols <-viridis_pal(option="viridis")(3)
## Just a quick check on GDDs
quartz(width=4, height=4)
if(use.fstar==TRUE){
ggplot(df.fstar, aes(x=df.fstar$gdd)) + geom_histogram(aes(fill=site)) + theme_classic() +
scale_fill_manual(name="Site", values=cols, labels=sort(unique(df.fstar$site)))
}
if(use.doy==TRUE){
ggplot(bball, aes(x=gdd.obs)) + geom_histogram(aes(fill=site)) + theme_classic() +
scale_fill_manual(name="Site", values=cols, labels=sort(unique(df$site)))
}
if(use.doy == TRUE){
### Okay, first let's check on site level varition in temperature
#### Before moving on, let's look at the data a bit
ws <- ggplot(df[(df$method=="ws"),], aes(x=tmean)) + geom_histogram(aes(fill=site)) + theme_classic() +
scale_fill_manual(name="Site", values=cols, labels=sort(unique(df$site))) + ggtitle("Weather Station") +
coord_cartesian(xlim=c(-10, 25))
hl <- ggplot(df[(df$method=="hobo"),], aes(x=tmean)) + geom_histogram(aes(fill=site)) + theme_classic() +
scale_fill_manual(name="Site", values=cols, labels=sort(unique(df$site))) + ggtitle("Hobo Logger") +
coord_cartesian(xlim=c(-10, 25))
quartz(width=6, height=4)
grid.arrange(ws, hl, ncol=2)
}
### Now let's look at GDD differences between methods
quartz(width=6, height=5)
par(mfrow=c(1,2))
my.pal <- viridis_pal(option="magma")(20)
my.pch <- c(15:16)
plot(gdd ~ species, col=my.pal[as.factor(bball$species)], pch=my.pch[as.factor(bball$site)], data = bball[(bball$method=="ws"),], main="Weather Station",
ylab="GDD", ylim=c(0, 600))
abline(h=mean(bball$gdd[bball$method=="ws"]), lwd=3)
plot(gdd ~ species, col=my.pal[as.factor(bball$species)], pch=my.pch[as.factor(bball$site)], data = bball[(bball$method=="hobo"),], main="Hobo Logger",
ylab="GDD", ylim=c(0, 600))
abline(h=mean(bball$gdd[bball$method=="hobo"]), lwd=3)
### Next, we can take a quick glimpse at results
if(use.urban==TRUE){
bball$urban <- ifelse(bball$site=="arb", 1, 0)
bball$type <- ifelse(bball$method=="ws", 1, 0)
modall <- lmer(gdd ~ urban + type + (urban + type|species), data=bball)
arm::display(modall)
}
# housekeeping
rm(list=ls())
options(stringsAsFactors = FALSE)
#### Questions to address:
# GDDlo ~ urban + (urban|species)
## Let's start with Question 1 first...
#library(rethinking)
library(RColorBrewer)
library(viridis)
library(lme4)
library(ggplot2)
library(gridExtra)
library(rstan)
## Let's load some real data to check out.
setwd("~/Documents/git/microclimates/analyses/")
if(FALSE){
ws <- read.csv("output/clean_gdd_chill_bbanddvr.csv")
mean(ws$gdd_bb, na.rm=TRUE) ## 292
sd(ws$gdd_bb, na.rm = TRUE) ## 116
mean(ws$budburst) ## 109.15
sd(ws$budburst) ## 14.22
mean(ws$budburst[ws$type=="Harvard Forest"]) ## 132.75
mean(ws$budburst[ws$type=="Treespotters"]) ## 112.45
}
use.urban = TRUE
use.provenance = FALSE
use.fstar = FALSE ### This is hypothesis B: Hobos are less accurate measures of effectively the same weather
use.doy = TRUE ### This is Hypoth A: Hobos better estimate true GDD -- capture microclimate and/or they capture treatments (urban, prov, method) better…
if(use.urban == TRUE & use.provenance == TRUE){
print("Error has occurred. Can't have both urban and provenance equal TRUE!")
}
if(use.fstar == TRUE & use.doy == TRUE){
print("Error has occurred. Can't have both fstar and doy equal TRUE!")
}
# Step 1: Set up years, days per year, temperatures, sampling frequency, required GDD (fstar)
daysperyr <- 200 #### just to make sure we don't get any NAs
nspps <- 20
ninds <- 10
nobs <- nspps*ninds
nsites <- 2
nmicros <- 10
nmethods <- 2 ## weather station and hobo logger to start (want to eventually add in gridded climate data)
if(use.urban==TRUE & use.fstar==TRUE){
urbeffect <- -75  ### mu_b_tx_sp
urbsd <- 20 ## sigma_b_tx_sp
methodeffect <- -75 ## mu_b_method_sp
methodsd <- 20 ## sigma_b_method_sp
}
if(use.urban==TRUE & use.doy==TRUE){
urbeffect <- 50  ### mu_b_tx_sp
urbsd <- 3 ## sigma_b_tx_sp
methodeffect <- 50 ## mu_b_method_sp
methodsd <- 10 ## sigma_b_method_sp
}
if(use.provenance==TRUE){
proveffect <- -5
provsd <- 0 ## sigma_b_tx_sp
methodeffect <- 100 ## mu_b_method_sp
methodsd <- 0 ## sigma_b_method_sp
}
fstar <- 400 ## day of budburst now (this should be mu_a_sp)
fstarspeciessd <- 50 ### sigma_a_sp
fstarindsd <- 20 ## sigma_y
if(use.doy==TRUE){
doybb <- 80 ## day of budburst now (this should be mu_a_sp)
doybbspeciessd <- 5### sigma_a_sp
doybbindsd <- 2 ## sigma_y
}
dayz <- rep(1:daysperyr, nobs)
cc.arb <- 6 ## based off weather station data
microarb.effect <- -2
sigma.arb <- 2
microsigmaarb.effect <- 1   #### by keeping the sigmas the same for the microsites (line 76 & 81) we assume that the microclimatic effects are the same across sites
cc.hf <- 4  ## based off weather station data
microhf.effect <- -2
sigma.hf <- 2
microsigmahf.effect <- 1  #### by keeping the sigmas the same for the microsites (line 76 & 81) we assume that the microclimatic effects are the same across sites
#source("simulations/micro_databuildfx.R")
if(use.fstar==TRUE){
source("simulations/micro_databuildfx.R")
}
if(use.doy==TRUE){
source("simulations/micro_databuildfx_doy.R")
}
cols <-viridis_pal(option="viridis")(3)
## Just a quick check on GDDs
quartz(width=4, height=4)
if(use.fstar==TRUE){
ggplot(df.fstar, aes(x=df.fstar$gdd)) + geom_histogram(aes(fill=site)) + theme_classic() +
scale_fill_manual(name="Site", values=cols, labels=sort(unique(df.fstar$site)))
}
if(use.doy==TRUE){
ggplot(bball, aes(x=gdd.obs)) + geom_histogram(aes(fill=site)) + theme_classic() +
scale_fill_manual(name="Site", values=cols, labels=sort(unique(df$site)))
}
nrow(bball$site=="hf")
nrow(bball[bball$site=="hf"])
nrow(bball[(bball$site=="hf"),])
bball <- df.bb[!duplicated(c(df.bb$site,df.bb$method, df.bb$species, df.bb$ind, df.bb$bb, df.bb$fstar, df.bb$provenance)),]
View(df)
table(df$site)
table(df.bb$site)
table(bbs$site)
# Step 3: Make a data frame and get the mean temp per year (to double check the data)
df <- dplyr::full_join(arbclim, hfclim)
df$tmean <- as.numeric(df$tmean)
df$sp_ind <- paste(df$species, df$ind, sep="_")
df$gdd.obs <- ave(df$tmean, df$sp_ind, df$site, df$method, FUN=cumsum)
df$urbtx <- ifelse(df$site=="arb", 1, 0)
df$gdd <- df$gdd.obs + df$urbtx * urbeffect + urbsd
df$tx <- ifelse(df$method=="ws", 1, 0)
df$gdd <- df$gdd + df$tx * methodeffect + methodsd
table(df$site)
table(df$gdd)
range(df$gdd)
range(df$gdd.obs)
range(df$gdd.obs[df$site=="hf"])
range(df$gdd[df$site=="hf"])
range(df$fstar[df$site=="hf"])
range(df$fstar[df$site=="hf"], na.rm=TRUE)
View(df.fstar)
df$urbtx * urbeffect
df$gdd.obs + df$urbtx * urbeffect + urbsd
hist(df$gdd)
hist(df$gdd.obs)
View(df)
# Step 3: Make a data frame and get the mean temp per year (to double check the data)
df <- dplyr::full_join(arbclim, hfclim)
df$tmean <- as.numeric(df$tmean)
df$sp_ind <- paste(df$species, df$ind, sep="_")
df$gdd.obs <- ave(df$tmean, df$sp_ind, df$site, df$method, FUN=cumsum)
df$urbtx <- ifelse(df$site=="arb", 1, 0)
df$gdd <- df$gdd.obs + df$urbtx * urbeffect + urbsd
df$tx <- ifelse(df$method=="ws", 1, 0)
df$gdd <- df$gdd + df$tx * methodeffect + methodsd
df$species <- as.character(df$species)
df <- left_join(df, df.fstar)
# housekeeping
rm(list=ls())
options(stringsAsFactors = FALSE)
#### Questions to address:
# GDDlo ~ urban + (urban|species)
## Let's start with Question 1 first...
#library(rethinking)
library(RColorBrewer)
library(viridis)
library(lme4)
library(ggplot2)
library(gridExtra)
library(rstan)
## Let's load some real data to check out.
setwd("~/Documents/git/microclimates/analyses/")
if(FALSE){
ws <- read.csv("output/clean_gdd_chill_bbanddvr.csv")
mean(ws$gdd_bb, na.rm=TRUE) ## 292
sd(ws$gdd_bb, na.rm = TRUE) ## 116
mean(ws$budburst) ## 109.15
sd(ws$budburst) ## 14.22
mean(ws$budburst[ws$type=="Harvard Forest"]) ## 132.75
mean(ws$budburst[ws$type=="Treespotters"]) ## 112.45
}
use.urban = TRUE
use.provenance = FALSE
use.fstar = FALSE ### This is hypothesis B: Hobos are less accurate measures of effectively the same weather
use.doy = TRUE ### This is Hypoth A: Hobos better estimate true GDD -- capture microclimate and/or they capture treatments (urban, prov, method) better…
if(use.urban == TRUE & use.provenance == TRUE){
print("Error has occurred. Can't have both urban and provenance equal TRUE!")
}
if(use.fstar == TRUE & use.doy == TRUE){
print("Error has occurred. Can't have both fstar and doy equal TRUE!")
}
# Step 1: Set up years, days per year, temperatures, sampling frequency, required GDD (fstar)
daysperyr <- 200 #### just to make sure we don't get any NAs
nspps <- 20
ninds <- 10
nobs <- nspps*ninds
nsites <- 2
nmicros <- 10
nmethods <- 2 ## weather station and hobo logger to start (want to eventually add in gridded climate data)
if(use.urban==TRUE & use.fstar==TRUE){
urbeffect <- -75  ### mu_b_tx_sp
urbsd <- 20 ## sigma_b_tx_sp
methodeffect <- -75 ## mu_b_method_sp
methodsd <- 20 ## sigma_b_method_sp
}
if(use.urban==TRUE & use.doy==TRUE){
urbeffect <- 50  ### mu_b_tx_sp
urbsd <- 3 ## sigma_b_tx_sp
methodeffect <- 10 ## mu_b_method_sp
methodsd <- 10 ## sigma_b_method_sp
}
if(use.provenance==TRUE){
proveffect <- -5
provsd <- 0 ## sigma_b_tx_sp
methodeffect <- 100 ## mu_b_method_sp
methodsd <- 0 ## sigma_b_method_sp
}
fstar <- 300 ## day of budburst now (this should be mu_a_sp)
fstarspeciessd <- 50 ### sigma_a_sp
fstarindsd <- 20 ## sigma_y
if(use.doy==TRUE){
doybb <- 80 ## day of budburst now (this should be mu_a_sp)
doybbspeciessd <- 5### sigma_a_sp
doybbindsd <- 2 ## sigma_y
}
dayz <- rep(1:daysperyr, nobs)
cc.arb <- 6 ## based off weather station data
microarb.effect <- -2
sigma.arb <- 2
microsigmaarb.effect <- 1   #### by keeping the sigmas the same for the microsites (line 76 & 81) we assume that the microclimatic effects are the same across sites
cc.hf <- 4  ## based off weather station data
microhf.effect <- -2
sigma.hf <- 2
microsigmahf.effect <- 1  #### by keeping the sigmas the same for the microsites (line 76 & 81) we assume that the microclimatic effects are the same across sites
#source("simulations/micro_databuildfx.R")
if(use.fstar==TRUE){
source("simulations/micro_databuildfx.R")
}
if(use.doy==TRUE){
source("simulations/micro_databuildfx_doy.R")
}
View(bball)
bball <- df.bb[!duplicated(c(df.bb$site,df.bb$method, df.bb$species, df.bb$ind, df.bb$bb, df.bb$fstar, df.bb$provenance)),]
